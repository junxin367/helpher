{"version":3,"sources":["assets\\Game\\Scripts\\UI\\UIChapterItem.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import mvcView from \"../../../framework/ui/mvcView\";\nimport { PlayerInfo } from \"../Common/Base/PlayerInfo\";\nimport { Toast } from \"../../../framework/ui/ToastManager\";\nimport LoadingScene from \"../Common/Base/LoadingScene\";\nimport { LevelInfo } from \"../Common/LevelInfo\";\nimport { SettingInfo } from \"../../../framework/extension/weak_net_game/SettingInfo\";\nimport Device from \"../../../framework/misc/Device\";\nimport { ChapterlInfo } from \"../Common/ChapterlInfo\";\nimport Switcher from \"../../../framework/ui/controller/Switcher\";\nimport Const from \"../Common/Const\";\nimport ccUtil from \"../../../framework/utils/ccUtil\";\nimport { UserInfo } from \"../../../framework/extension/weak_net_game/UserInfo\";\nimport { StarInfo } from \"../Common/StarInfo\";\n\nconst { ccclass, property } = cc._decorator;\n\n@ccclass\nexport default class UIChapterItem extends mvcView {\n    @property(cc.Label)\n    label_chapter: cc.Label = null;\n\n    @property(cc.Sprite)\n    icon: cc.Sprite = null;\n\n    @property(cc.Node)\n    level_node: cc.Node = null;\n\n    @property(cc.Node)\n    lock_node: cc.Node = null;\n\n    @property(cc.Node)\n    unlock_node: cc.Node = null;\n\n    @property(cc.Label)\n    lock_label: cc.Label = null;\n\n    @property(cc.Label)\n    star_label: cc.Label = null;\n\n    @property(cc.Node)\n    left: cc.Node = null;\n\n    @property(cc.Node)\n    right: cc.Node = null;\n\n    page: number = 0;\n\n    onLoad() {\n        this.register(this.label_chapter, _ => this.showLabel());\n        this.register(this.icon, _ => this.showIcon())\n    }\n\n    onLaterRender() {\n        let data = this.getData() as ChapterlInfo;\n        if (PlayerInfo.star >= ccUtil.get(StarInfo, data.id).demand && (data.id - 1) * 10 < PlayerInfo.level) {\n            this.lock_node.active = false;\n            this.unlock_node.active = true;\n        }\n        else {\n            this.lock_node.active = true;\n            this.unlock_node.active = false;\n            this.lock_label.string = \"达到\" + ccUtil.get(StarInfo, data.id).demand + \"星解锁\";\n        }\n        if ((PlayerInfo.level - (data.id - 1) * 10) > 5 && PlayerInfo.level > (data.id - 1) * 10) {\n            this.page = 1;\n            this.right.active = false;\n            this.left.active = true;\n        }\n        else {\n            this.page = 0;\n            this.right.active = true;\n            this.left.active = false;\n        }\n        this.refresh_level();\n        this.starNum();\n    }\n\n    refresh_level() {\n        let data = this.getData() as ChapterlInfo;\n        if ((data.id - 1) * 10 > PlayerInfo.level) {\n            return;\n        }\n        for (let i = 0; i < this.level_node.children.length; i++) {\n            let level = ((data.id - 1) * 10) + (this.page * 5 + i + 1);\n            this.onClick(this.level_node.children[i], _ => this.click_Chapter(level));\n            this.level_node.children[i].getComponentInChildren(Switcher).index = PlayerInfo.level_star[level];\n            this.level_node.children[i].getComponentInChildren(cc.Label).string = level + \"\";\n            let levelNow_node = this.level_node.children[i].getChildByName(\"dangqian\");\n            if (level == PlayerInfo.level) {\n                levelNow_node.color = cc.color(235, 113, 0, 255);\n            }\n            else if (level < PlayerInfo.level) {\n                levelNow_node.color = cc.color(105, 185, 30, 255);\n\n            }\n            else {\n                levelNow_node.color = cc.Color.GRAY;\n\n            }\n        }\n    }\n\n    starNum() {\n        let data = this.getData() as ChapterlInfo;\n        let num = 0;\n        for (let i = (data.id - 1) * 10 + 1; i <= data.id * 10; i++) {\n            num += PlayerInfo.level_star[i];\n        }\n        this.star_label.string = num + \"/30\";\n    }\n\n    showIcon() {\n        let data = this.getData() as ChapterlInfo;\n        if (PlayerInfo.getChapter() < data.id) {\n            // this.icon.node.color = cc.Color.GRAY;\n            return \"ImagePart/chapter/jingqingqidai\";\n        }\n        //  else {\n        //     this.icon.node.color = cc.Color.WHITE\n        // }\n        if (Const.Chapter_Unlock < data.id) return \"ImagePart/chapter/1\";\n\n        return \"ImagePart/chapter/\" + data.id;\n    }\n\n    showLabel() {\n        let data = this.getData() as ChapterlInfo;\n        return \"第\" + data.id + \"章\";\n    }\n\n    click_left() {\n        if (this.page != 1) {\n            return;\n        }\n        this.page = 0;\n        this.right.active = true;\n        this.left.active = false;\n        this.refresh_level();\n    }\n\n    click_right() {\n        if (this.page != 0) {\n            return;\n        }\n        this.page = 1;\n        this.right.active = false;\n        this.left.active = true;\n        this.refresh_level();\n    }\n\n    click_Chapter(level) {\n        console.log(level)\n\n        let lv = PlayerInfo.getCurrentLevel();\n        if (lv < level) {\n            Toast.make(\"未解锁\")\n            return;\n        }\n        if (PlayerInfo.labour > 0) {\n            PlayerInfo.labour--;\n            PlayerInfo.playinglevel = level;\n            PlayerInfo.save();\n            LoadingScene.goto(\"Game\");\n        }\n        else {\n            // Toast.make(\"体力不足\");\n            vm.show(\"Prefabs/UI/UIGetLabour\", _ => {\n                PlayerInfo.labour--;\n                if (PlayerInfo.isPlayingDaily) {\n                    PlayerInfo.playingDailyLevel = level;\n                } else {\n                    PlayerInfo.playinglevel = level;\n                }\n                PlayerInfo.save();\n                LoadingScene.goto(\"Game\");\n            }, false);\n        }\n    }\n}\n"]}