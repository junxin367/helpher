{"version":3,"sources":["assets\\Game\\Scripts\\UI\\UIEgg.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import mvcView from \"../../../framework/ui/mvcView\";\nimport { Toast } from \"../../../framework/ui/ToastManager\";\nimport { evt } from \"../../../framework/core/event\";\nimport Platform from \"../../../framework/extension/Platform\";\nimport { PlayerInfo } from \"../Common/Base/PlayerInfo\";\nimport display from \"../../../framework/misc/display\";\n\n\nlet { ccclass, property } = cc._decorator\n@ccclass\nexport default class UIEgg extends mvcView {\n\n    @property(cc.ProgressBar)\n    Bar: cc.ProgressBar = null;\n\n    @property(cc.Animation)\n    egg_ani: cc.Animation = null;\n\n    @property(cc.ParticleSystem)\n    lizi: cc.ParticleSystem = null;\n\n    @property(cc.Node)\n    egg1: cc.Node = null;\n\n    @property(cc.Node)\n    get_but: cc.Node = null;\n\n    isbanner: boolean = false;\n    isshowed: boolean = false;\n  \n    randomNum: number = 0;\n    view: string = \"\";\n\n    onLoad() {\n       \n    }\n\n    onShow(view) {\n        \n        evt.on(\"Game.Resume\", this.onResume, this);\n        this.egg_ani.on(cc.Animation.EventType.FINISHED, this.finsh,this)\n        this.Bar.progress = 0;\n        this.view = view;\n        this.isshowed = false;\n        this.randomNum = g.randomFloat(0.4,0.6);\n        Platform.refreshBannerAd();\n    }\n    onResume(){\n        Platform.hideBannerAd();\n    }\n\n    onDestroy() {\n      \n    }\n\n    async click_egg() {\n        this.unschedule(this.reduce_propress);\n        this.Bar.progress += 0.1;\n        if (this.Bar.progress >= this.randomNum && !this.isshowed) {\n            this.isshowed = true;\n            this.egg1.y += 10;\n            Platform.showBannerAd();\n            this.isbanner = true;\n            this.scheduleOnce(_ => {\n                if(cc.isValid(this)){\n                    this.isbanner = false;\n                    Platform.hideBannerAd();\n                }\n            }, 2)\n        }\n        if (this.Bar.progress >= 1) {\n            this.unscheduleAllCallbacks();\n            this.get_but.active = false;\n            Toast.make(\"恭喜获得体力 1\");\n            evt.emit(\"Game.getTili\", display.center, 1);\n            PlayerInfo.labour += 1;\n            this.egg_ani.play(\"egg2\");\n            return;\n        }\n        this.schedule(this.reduce_propress, 0.1);\n    }\n\n    reduce_propress() {\n        if (this.isbanner) return;\n        this.Bar.progress -= 0.01;\n        if(this.Bar.progress <= 0){\n            // this.unschedule(this.reduce_propress);\n            this.Bar.progress = 0;\n            return;\n        }\n    }\n\n    onHidden() {\n        evt.off(this);\n        this.egg_ani.off(cc.Animation.EventType.FINISHED, this.finsh,this)\n        Platform.hideBannerAd();\n        this.isbanner = false;\n    }\n\n    finsh(){\n        vm.hide(this);\n        if (this.view == \"win\") {\n            vm.show(\"Prefabs/UI/UIWin\");\n        }\n        else if (this.view == \"lose\") {\n            vm.show(\"Prefabs/UI/UILose\");\n        }            \n    }\n\n\n}"]}