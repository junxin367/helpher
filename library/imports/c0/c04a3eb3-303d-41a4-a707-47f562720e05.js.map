{"version":3,"sources":["assets\\Game\\Scripts\\UI\\UIChapter.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["\n\nimport mvcView from \"../../../framework/ui/mvcView\";\nimport { LevelInfo } from \"../Common/LevelInfo\";\nimport ccUtil from \"../../../framework/utils/ccUtil\";\nimport { SettingInfo } from \"../../../framework/extension/weak_net_game/SettingInfo\";\nimport Device from \"../../../framework/misc/Device\";\nimport { ChapterlInfo } from \"../Common/ChapterlInfo\";\nimport Const from \"../Common/Const\";\nimport { PlayerInfo } from \"../Common/Base/PlayerInfo\";\nimport Main from \"../Main\";\nimport { UserInfo } from \"../../../framework/extension/weak_net_game/UserInfo\";\nimport { ConfirmOption } from \"./UIConfirm\";\nimport LoadingScene from \"../Common/Base/LoadingScene\";\nimport { buffSystem } from \"../../../framework/extension/buffs/BuffSystem\";\n\nconst { ccclass, property } = cc._decorator;\n\n@ccclass\nexport default class UIChapter extends mvcView {\n\n    @property(cc.Layout)\n    layout: cc.Layout = null;\n\n    @property(cc.ScrollView)\n    scoreView: cc.ScrollView = null;\n\n\n    datas: ChapterlInfo[] = [];\n\n    onLoad() {\n        this.register(this.layout, _ => this.datas);\n    }\n\n    onShow() {\n        this.datas.splice(0);\n        csv.Chapter.values.map(e => {\n            let data = ccUtil.get(ChapterlInfo, e.id);\n            if (data.id <= Const.Chapter_Unlock + 1)\n                this.datas.push(data);\n        });\n        this.render();\n        if (PlayerInfo.level > 20) {\n            this.scoreView.scrollToPercentVertical((1 - PlayerInfo.level / 10 / 12), 0.2);\n        }\n        else {\n            this.scoreView.scrollToPercentVertical(1, 0.2);\n        }\n    }\n\n    start() {\n\n    }\n\n    click_play() {\n        if (PlayerInfo.labour > 0) {\n            if (!UserInfo.gun_num && !UserInfo.isGetGunStart) {\n                let ran = Math.random();\n                if (PlayerInfo.level >= csv.Config.Start_Lv_Get_Gun\n                    && UserInfo.gunViewDay < csv.Config.Get_Gun_Limt_Day\n                    && UserInfo.gunView < csv.Config.Get_Gun_Limt\n                    && ran < csv.Config.Get_Gun_Pro\n                ) {\n                    vm.show(\"Prefabs/UI/UIGetGun\", _ => {\n                        this.confirm();\n                    }, \"isGetGunStart\");\n                    return;\n                }\n\n\n            }\n            this.confirm();\n        } else {\n            vm.show(\"Prefabs/UI/UIGetLabour\", _ => {\n                this.confirm();\n            }, false);\n        }\n\n    }\n\n    confirm() {\n        if (PlayerInfo.level >= csv.level.size) {\n            if (PlayerInfo.dailylevel <= PlayerInfo.maxDailyLv) {\n                vm.show(\"Prefabs/UI/UIConfirm\", \"是否前往挑战关卡？\", this.onConfirm_challenge, this);\n            } else {\n                vm.show(\"Prefabs/UI/UIConfirm\", \"是否随机开始之前的关卡\", this.onConfirm, this);\n                return;\n            }\n\n        } else {\n            this.flytili();\n        }\n    }\n\n    onConfirm_challenge(option: ConfirmOption) {\n        if (option == ConfirmOption.Yes) {\n            PlayerInfo.isPlayingDaily = true;\n            vm.show(\"Prefabs/UI/UIChallengeChapter\");\n        } else {\n            vm.show(\"Prefabs/UI/UIConfirm\", \"是否随机开始之前的关卡\", this.onConfirm, this);\n        }\n    }\n\n    onConfirm(option: ConfirmOption) {\n        if (option == ConfirmOption.Yes) {\n            PlayerInfo.isRandomLevel = true;\n            let lvrow = csv.level.get(g.randomInt(2, csv.level.size))\n            this.flytili(lvrow.id);\n        } else {\n            PlayerInfo.isRandomLevel = false;\n        }\n    }\n\n    flytili(id?) {\n        PlayerInfo.isPlayingDaily = false;\n        PlayerInfo.labour--;\n        PlayerInfo.save(\"labour\");\n        if (PlayerInfo.labour <= csv.Config.Max_Energy - 1) {\n            buffSystem.startBuff(\"AutoLabour\", PlayerInfo.buff_labour || 300);\n        }\n        if (id) {\n            PlayerInfo.playinglevel = id;\n        } else {\n            PlayerInfo.playinglevel = PlayerInfo.level;\n        }\n        LoadingScene.goto(\"Game\");\n    }\n\n    clic_close() {\n\n\n        vm.hide(this);\n    }\n\n    // update (dt) {}\n}\n"]}