{"version":3,"sources":["assets\\Game\\Scripts\\UI\\UIFriendHelpItem.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;AAAA,yDAAoD;AACpD,mDAAuD;AACvD,4DAAgE;AAEhE,mEAA2D;AAC3D,wDAAuD;AACvD,+CAAyD;AACzD,sEAAiE;AACjE,sFAAiF;AACjF,kEAA6D;AAC7D,uDAAoD;AAEhD,IAAA,KAAwB,EAAE,CAAC,UAAU,EAAnC,OAAO,aAAA,EAAE,QAAQ,cAAkB,CAAA;AAEzC;IAA8C,oCAAO;IAArD;QAAA,qEAwEC;QArEG,eAAS,GAAc,IAAI,CAAC;QAG5B,gBAAU,GAAc,IAAI,CAAC;QAG7B,gBAAU,GAAa,IAAI,CAAC;QAG5B,aAAO,GAAa,IAAI,CAAC;QAGzB,eAAS,GAAa,IAAI,CAAC;;IAyD/B,CAAC;IAvDG,iCAAM,GAAN;QACI,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,SAAS,EAAE,IAAI,CAAC,WAAW,CAAC,CAAA;QAC/C,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,UAAU,EAAE,IAAI,CAAC,WAAW,CAAC,CAAA;IACpD,CAAC;IAED,gCAAK,GAAL;IAEA,CAAC;IAED,kCAAO,GAAP,UAAQ,UAAqB,EAAE,KAAa;QACxC,IAAI,CAAC,UAAU,CAAC,MAAM,GAAG,GAAG,GAAG,CAAC,KAAK,GAAG,CAAC,CAAC,GAAG,MAAM,CAAA;QACnD,IAAI,CAAC,OAAO,CAAC,MAAM,GAAG,IAAI,CAAA;QAC1B,IAAI,KAAK,IAAI,UAAU,CAAC,YAAY,IAAI,KAAK,GAAG,UAAU,CAAC,YAAY,EAAE;YACrE,KAAK;YACL,IAAI,CAAC,SAAS,CAAC,KAAK,GAAG,CAAC,CAAC;SAC5B;aAAM;YACH,IAAI,KAAK,GAAG,UAAU,CAAC,YAAY,EAAE;gBACjC,KAAK;gBACL,IAAI,CAAC,SAAS,CAAC,KAAK,GAAG,CAAC,CAAC;aAC5B;iBAAM;gBACH,KAAK;gBACL,IAAI,CAAC,SAAS,CAAC,KAAK,GAAG,CAAC,CAAC;aAC5B;SACJ;IACL,CAAC;IAED,sCAAW,GAAX;QACI,kBAAQ,CAAC,KAAK,EAAE,CAAC;IACrB,CAAC;IAED,sCAAW,GAAX;QAAA,iBAwBC;QAvBG,qBAAW,CAAC,MAAM,CAAC,OAAO,CAAC,kBAAG,CAAC,gBAAgB,CAAC,CAAC,IAAI,CAAC,UAAA,CAAC;YACnD,IAAI,CAAC,IAAI,aAAG,CAAC,IAAI,CAAC,OAAO,EAAE;gBACvB,oBAAK,CAAC,IAAI,CAAC,OAAO,CAAC,CAAA;aACtB;iBAAM;gBACH,IAAI,CAAC,EAAE;oBACH,IAAI,GAAG,GAAG,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;oBACxB,IAAI,GAAG,GAAG,GAAG,CAAC,IAAI,CAAC;oBACnB,IAAI,GAAG,CAAC,KAAK,IAAI,CAAC,EAAE;wBAChB,oBAAK,CAAC,IAAI,CAAC,OAAO,GAAG,GAAG,CAAC,KAAK,CAAC,CAAC;qBACnC;yBAAM;wBACH,KAAK;wBACL,IAAI,GAAG,GAAG,GAAG,CAAC,GAAG,IAAI,CAAC,CAAA;wBACtB,uBAAU,CAAC,SAAS,CAAC,GAAG,CAAC,CAAC;wBAC1B,oBAAK,CAAC,IAAI,CAAC,MAAM,GAAG,GAAG,GAAG,KAAK,CAAC,CAAC;wBACjC,KAAI,CAAC,SAAS,CAAC,KAAK,GAAG,CAAC,CAAC;wBACzB,sBAAY,CAAC,UAAU,CAAC,YAAY,EAAE,CAAC;wBACvC,WAAG,CAAC,IAAI,CAAC,iBAAiB,EAAE,sBAAY,CAAC,UAAU,EAAE,sBAAY,CAAC,UAAU,CAAC,CAAA;qBAChF;iBACJ;qBAAM;oBACH,oBAAK,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAA;iBACvB;aACJ;QACL,CAAC,CAAC,CAAA;IACN,CAAC;IApED;QADC,QAAQ,CAAC,EAAE,CAAC,MAAM,CAAC;uDACQ;IAG5B;QADC,QAAQ,CAAC,EAAE,CAAC,MAAM,CAAC;wDACS;IAG7B;QADC,QAAQ,CAAC,EAAE,CAAC,KAAK,CAAC;wDACS;IAG5B;QADC,QAAQ,CAAC,EAAE,CAAC,KAAK,CAAC;qDACM;IAGzB;QADC,QAAQ,CAAC,kBAAQ,CAAC;uDACQ;IAfV,gBAAgB;QADpC,OAAO;OACa,gBAAgB,CAwEpC;IAAD,uBAAC;CAxED,AAwEC,CAxE6C,iBAAO,GAwEpD;kBAxEoB,gBAAgB","file":"","sourceRoot":"/","sourcesContent":["import mvcView from \"../../../framework/ui/mvcView\";\r\nimport Net, { net } from \"../../../framework/misc/Net\";\r\nimport { ServerConfig, Api } from \"../Common/Base/ServerConfig\";\r\nimport { UserInfo } from \"../../../framework/extension/weak_net_game/UserInfo\";\r\nimport { Toast } from \"../../../framework/ui/ToastManager\";\r\nimport { PlayerInfo } from \"../Common/Base/PlayerInfo\";\r\nimport UIFriendHelp, { SumInvite } from \"./UIFriendHelp\";\r\nimport Switcher from \"../../../framework/ui/controller/Switcher\";\r\nimport WeakNetGame from \"../../../framework/extension/weak_net_game/WeakNetGame\";\r\nimport Platform from \"../../../framework/extension/Platform\";\r\nimport { evt } from \"../../../framework/core/event\";\r\n\r\nlet { ccclass, property } = cc._decorator\r\n@ccclass\r\nexport default class UIFriendHelpItem extends mvcView {\r\n\r\n    @property(cc.Button)\r\n    btn_claim: cc.Button = null;\r\n\r\n    @property(cc.Button)\r\n    btn_invite: cc.Button = null;\r\n\r\n    @property(cc.Label)\r\n    label_text: cc.Label = null;\r\n\r\n    @property(cc.Label)\r\n    label_c: cc.Label = null;\r\n\r\n    @property(Switcher)\r\n    tg_status: Switcher = null;\r\n\r\n    onLoad() {\r\n        this.register(this.btn_claim, this.click_claim)\r\n        this.register(this.btn_invite, this.click_share)\r\n    }\r\n\r\n    start() {\r\n\r\n    }\r\n\r\n    setData(sum_invite: SumInvite, index: number) {\r\n        this.label_text.string = \"第\" + (index + 1) + \"位新好友\"\r\n        this.label_c.string = \"x2\"\r\n        if (index >= sum_invite.claimedCount && index < sum_invite.inviteeCount) {\r\n            //可领取\r\n            this.tg_status.index = 1;\r\n        } else {\r\n            if (index < sum_invite.claimedCount) {\r\n                //已领取\r\n                this.tg_status.index = 2;\r\n            } else {\r\n                //待邀请\r\n                this.tg_status.index = 0;\r\n            }\r\n        }\r\n    }\r\n\r\n    click_share() {\r\n        Platform.share();\r\n    }\r\n\r\n    click_claim() {\r\n        WeakNetGame.client.httpGet(Api.invite_claim_new).then(v => {\r\n            if (v == Net.Code.Timeout) {\r\n                Toast.make(\"领取超时!\")\r\n            } else {\r\n                if (v) {\r\n                    let res = JSON.parse(v);\r\n                    let ret = res.data;\r\n                    if (res.errno != 0) {\r\n                        Toast.make(\"领取失败:\" + res.errno);\r\n                    } else {\r\n                        // ok\r\n                        let add = ret.num || 2\r\n                        PlayerInfo.addLabour(add);\r\n                        Toast.make(\"成功领取\" + add + \"个体力\");\r\n                        this.tg_status.index = 2;\r\n                        UIFriendHelp.sum_invite.claimedCount++;\r\n                        evt.emit(\"Game.friendTili\", UIFriendHelp.day_invite, UIFriendHelp.sum_invite)\r\n                    }\r\n                } else {\r\n                    Toast.make(\"服务器出错!\")\r\n                }\r\n            }\r\n        })\r\n    }\r\n}\r\n"]}