{"version":3,"sources":["assets\\framework\\extension\\shooter\\SBullet2.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import GameEntity, { EntityState } from \"./SGameEntity\";\r\nimport { BulletInterface } from \"./SFireAgent\";\r\n\r\nconst { ccclass, property, menu, requireComponent } = cc._decorator;\r\n\r\n@ccclass\r\n@menu(\"shooter/BulletWithEntity\")\r\n@requireComponent(GameEntity)\r\nexport default class SBulletWithEntity extends cc.Component implements BulletInterface {\r\n\r\n    @property\r\n    speed: number = 5;\r\n\r\n    @property([cc.Sprite])\r\n    tails: cc.Sprite[] = []\r\n\r\n    @property\r\n    def_opacity: number = 155;\r\n\r\n    entity: GameEntity = null;\r\n\r\n    set damage(v) {\r\n        this.entity.damage = v;\r\n    }\r\n\r\n    onLoad() {\r\n        this.entity = this.getComponent(GameEntity);\r\n        this.entity.on(GameEntity.Event.Dead, this.onDead, this)\r\n        if (this.tails.length == 0) {\r\n            this.tails = this.getComponentsInChildren(cc.Sprite);\r\n            this.tails = this.tails.filter(v => v.node != this.node)\r\n        }\r\n    }\r\n\r\n    onDestroy() {\r\n        this.entity.off(GameEntity.Event.Dead, this.onDead, this)\r\n    }\r\n\r\n    onEnable() {\r\n        this.tails.forEach(v => {\r\n            v.node.width = 0\r\n            v.node.opacity = this.def_opacity;\r\n        })\r\n    }\r\n\r\n    onDead() {\r\n        this.tails.forEach(v => {\r\n            v.node.runAction(cc.fadeOut(0.2));\r\n        })\r\n    }\r\n\r\n    onCollisionEnter(other: cc.Collider, self) {\r\n\r\n        let entity = other.getComponent(GameEntity)\r\n        if (entity == null) {\r\n            entity = other.getComponentInParent(GameEntity);\r\n        }\r\n        if (entity.isActive && this.entity.isActive) {\r\n            entity.decreaseHp(this.entity.damage);\r\n            this.entity.decreaseHp(entity.damage)\r\n            this.onHitEntity(entity, other)\r\n        }\r\n    }\r\n\r\n    onHitEntity(entity: GameEntity, collider: cc.Collider) {\r\n\r\n    }\r\n\r\n    fire(v) {\r\n        if (this.entity.moveEngine) {\r\n            this.entity.moveEngine.velocity = v\r\n        }\r\n        this.entity.run()\r\n    }\r\n\r\n\r\n    update(dt) {\r\n        this.tails.forEach(v => {\r\n            v.node.width += this.speed;\r\n        })\r\n    }\r\n}\r\n"]}