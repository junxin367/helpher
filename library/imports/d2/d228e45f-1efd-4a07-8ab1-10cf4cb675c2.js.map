{"version":3,"sources":["assets\\framework\\ui\\controller\\Switcher.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import Signal from \"../../core/Signal\";\r\n\r\nconst { ccclass, property, menu, executeInEditMode, inspector } = cc._decorator;\r\n\r\n@ccclass\r\n@menu(\"Controller/Switcher\")\r\n@executeInEditMode()\r\n@inspector(\"packages://qcontroller/inspector/switcher.js\")\r\nexport default class Switcher extends cc.Component {\r\n    public children: cc.Node[] = null;\r\n\r\n    onValueChanged: Signal = new Signal();\r\n\r\n\r\n    @property()\r\n    _childrenCount: number = 0;\r\n\r\n    @property()\r\n    private _currentIndex: number = 0;\r\n\r\n\r\n    @property({ displayName: \"交互\" })\r\n    interactable: boolean = false;\r\n\r\n    @property({ displayName: \"当前值\" })\r\n    public get currentIndex(): number {\r\n        return this._currentIndex;\r\n    }\r\n\r\n    get index() {\r\n        return this.currentIndex;\r\n    }\r\n\r\n    @property(cc.Node)\r\n    _currentChild: cc.Node = null;\r\n\r\n\r\n    public set currentIndex(value: number) {\r\n        value = cc.misc.clampf(value, 0, this.children.length - 1);\r\n        value = Math.floor(value);\r\n        this._select(value);\r\n    }\r\n\r\n\r\n    public set resizeToCurrent(v) {\r\n        if (v) {\r\n            this.node.setContentSize(this._currentChild.getContentSize());\r\n        }\r\n    }\r\n\r\n    btn: cc.Button = null;\r\n\r\n    set _checkInteractive(v) {\r\n        if (v) {\r\n            this.btn = this.getComponent(cc.Button);\r\n            if (this.btn == null) {\r\n                this.btn = this.addComponent(cc.Button);\r\n                this.btn.target = this._currentChild;\r\n                let evt = new cc.Component.EventHandler();\r\n                evt.target = this.node;\r\n                evt.component = \"Switcher\";\r\n                evt.handler = \"switch\"\r\n                this.btn.clickEvents.push(evt);\r\n            }\r\n        } else {\r\n            if (this.btn) {\r\n                this.btn.destroy();\r\n            }\r\n        }\r\n    }\r\n\r\n\r\n    onLoad() {\r\n\r\n        // this._currentIndex = this.children.indexOf(this.currentActiveNode);\r\n    }\r\n\r\n    resetInEditor() {\r\n\r\n    }\r\n\r\n    start() {\r\n        this.children = this.node.children;\r\n        this._childrenCount = this.children.length;\r\n        this._select(this.currentIndex);\r\n        // this.resizeToCurrent = true;\r\n        this._checkInteractive = this.interactable;\r\n    }\r\n\r\n    _select(index: number) {\r\n        this._currentIndex = index;\r\n        this._currentChild = this.children[index];\r\n        for (let i = 0; i < this.children.length; i++) {\r\n            const element = this.children[i];\r\n            if (i == index) {\r\n                element.active = true;\r\n            } else {\r\n                element.active = false;\r\n            }\r\n        }\r\n    }\r\n\r\n    switch() {\r\n        this.index = (this.currentIndex + 1) % (this._childrenCount);\r\n    }\r\n\r\n    set index(index: number) {\r\n        if (!this.children) {\r\n            this._currentIndex = index;\r\n        }\r\n        if (this.currentIndex != index) {\r\n            this._select(index);\r\n            this.onValueChanged.fire(index);\r\n        }\r\n    }\r\n\r\n}"]}