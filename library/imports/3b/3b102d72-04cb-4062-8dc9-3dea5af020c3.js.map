{"version":3,"sources":["assets\\Game\\Scripts\\UI\\UIProgressReward.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import Box from \"../Box\";\r\nimport { Toast } from \"../../../framework/ui/ToastManager\";\r\nimport { PlayerInfo } from \"../Common/Base/PlayerInfo\";\r\n\r\nlet { ccclass, property } = cc._decorator\r\n\r\nconst BoxConfig = {\r\n    Skin: { percent: 45 },// random skin \r\n    Energy: { percent: 30, num: 3 },\r\n    Prop: { percent: 25 } //1,2,3\r\n}\r\n\r\n@ccclass\r\nexport default class UIProgressReward extends cc.Component {\r\n\r\n    @property(cc.Node)\r\n    layout: cc.Node = null;\r\n\r\n    pool: string[] = []\r\n\r\n    onLoad() {\r\n\r\n    }\r\n\r\n    once = true;\r\n    onShown() {\r\n        this.once = true;\r\n        this.layout.children.forEach(v => v.getChildByName(\"box\")!.active = false)\r\n        this.pool.splice(0)\r\n        if (!PlayerInfo.isAllSkinUnlocked()) {\r\n            for (let k in BoxConfig) {\r\n                let v = BoxConfig[k]\r\n                for (let i = 0; i < v.percent; i++) {\r\n                    this.pool.push(k)\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    click_box(sender, msg) {\r\n        if (!this.once) return;\r\n        this.once = false;\r\n        let id = parseInt(msg);\r\n        let box = this.layout.children[id];\r\n        let fx = box.getChildByName(\"box\")\r\n        fx.active = true;\r\n        let display = fx.getComponent(dragonBones.ArmatureDisplay)\r\n        display.playAnimation(\"open\", 1)\r\n        // open box \r\n        this.scheduleOnce(this.openBox, 0.5);\r\n    }\r\n\r\n    openBox() {\r\n        let k = 'Energy'\r\n        if (this.pool.length > 0) {\r\n            k = g.getRandom(this.pool)\r\n        } else {\r\n            if (Math.random() > 0.5) {\r\n                k = 'Prop'\r\n            }\r\n        }\r\n        let cfg = BoxConfig[k];\r\n        vm.show(\"Prefabs/UI/UIProgressRewardGet\", k, cfg)\r\n        this.scheduleOnce(this.hide, 1)\r\n    }\r\n\r\n    hide() {\r\n        vm.hide(this)\r\n    }\r\n}"]}