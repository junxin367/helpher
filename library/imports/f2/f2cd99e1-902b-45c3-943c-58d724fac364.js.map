{"version":3,"sources":["assets\\Game\\Scripts\\ArrowMachine.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;AAAA,yCAAoC;AACpC,iCAA4B;AAC5B,sDAAiD;AAG7C,IAAA,KAAwB,EAAE,CAAC,UAAU,EAAnC,OAAO,aAAA,EAAE,QAAQ,cAAkB,CAAA;AAEzC;IAA0C,gCAAY;IAAtD;QAAA,qEA2CC;QAxCG,kBAAY,GAAc,IAAI,CAAC;QAG/B,UAAI,GAAY,IAAI,CAAC;QAGrB,YAAM,GAAY,EAAE,CAAA;QAuBpB,gBAAU,GAAG,KAAK,CAAC;;IAWvB,CAAC;IAhCG,6BAAM,GAAN;QACI,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,uBAAuB,CAAC,eAAK,CAAC,CAAC;QAClD,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC,IAAI,CAAC,cAAc,CAAC,MAAM,CAAC,CAAA;IAChD,CAAC;IAED,4BAAK,GAAL;QACI,IAAI,CAAC,YAAY,CAAC,gBAAgB,CAAC,GAAG,CAAC,IAAI,CAAC,gBAAgB,EAAE,IAAI,CAAC,CAAA;IACvE,CAAC;IAED,gCAAS,GAAT;QACI,IAAI,IAAI,CAAC,YAAY,CAAC,gBAAgB;YAClC,IAAI,CAAC,YAAY,CAAC,gBAAgB,CAAC,GAAG,CAAC,IAAI,CAAC,gBAAgB,EAAE,IAAI,CAAC,CAAA;IAC3E,CAAC;IAGD,uCAAgB,GAAhB;QACI,IAAI,CAAC,GAAG,IAAI,CAAC,YAAY,CAAC,MAAM,CAAA;QAChC,IAAI,CAAC,EAAE;YACH,IAAI,CAAC,QAAQ,EAAE,CAAA;SAClB;IACL,CAAC;IAID,+BAAQ,GAAR;QACI,IAAI,IAAI,CAAC,UAAU;YAAE,OAAO;QAC5B,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC;QACvB,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC,UAAA,CAAC,IAAI,OAAA,CAAC,CAAC,EAAE,EAAE,EAAN,CAAM,CAAC,CAAA;QAChC,gBAAM,CAAC,OAAO,CAAC,cAAc,CAAC,CAAA;QAC9B,EAAE,CAAC,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,EAAE,CAAC,GAAG,EAAE,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC,KAAK,EAAE,CAAA;IACvD,CAAC;IAtCD;QADC,QAAQ,CAAC,EAAE,IAAI,EAAE,mBAAS,EAAE,WAAW,EAAE,OAAO,EAAE,CAAC;sDACrB;IAHd,YAAY;QADhC,OAAO;OACa,YAAY,CA2ChC;IAAD,mBAAC;CA3CD,AA2CC,CA3CyC,EAAE,CAAC,SAAS,GA2CrD;kBA3CoB,YAAY","file":"","sourceRoot":"/","sourcesContent":["import KeyToggle from \"./KeyToggle\";\r\nimport Arrow from \"./Arrow\";\r\nimport Device from \"../../framework/misc/Device\";\r\nimport { evt } from \"../../framework/core/event\";\r\n\r\nlet { ccclass, property } = cc._decorator\r\n@ccclass\r\nexport default class ArrowMachine extends cc.Component {\r\n\r\n    @property({ type: KeyToggle, displayName: \"触发的钥匙\" })\r\n    keyActivator: KeyToggle = null;\r\n\r\n\r\n    wood: cc.Node = null;\r\n\r\n\r\n    arrows: Arrow[] = []\r\n\r\n    onLoad() {\r\n        this.arrows = this.getComponentsInChildren(Arrow);\r\n        this.wood = this.node.getChildByName(\"wood\")\r\n    }\r\n\r\n    start() {\r\n        this.keyActivator.onToggleSwitched.add(this.onToggleSwitched, this)\r\n    }\r\n\r\n    onDestroy() {\r\n        if (this.keyActivator.onToggleSwitched)\r\n            this.keyActivator.onToggleSwitched.off(this.onToggleSwitched, this)\r\n    }\r\n\r\n\r\n    onToggleSwitched() {\r\n        let b = this.keyActivator.isOpen\r\n        if (b) {\r\n            this.activate()\r\n        }\r\n    }\r\n    _activated = false;\r\n\r\n\r\n    activate() {\r\n        if (this._activated) return;\r\n        this._activated = true;\r\n        this.arrows.forEach(v => v.go())\r\n        Device.playSfx(\"arrow_launch\")\r\n        cc.tween(this.wood).to(1.0, { opacity: 0 }).start()\r\n    }\r\n\r\n}"]}