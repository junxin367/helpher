{"version":3,"sources":["assets\\Game\\Scripts\\views\\FourComics.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import { EaseType } from \"../../../framework/extension/qanim/EaseType\";\r\n\r\nlet { ccclass, property } = cc._decorator\r\nenum AnimationType {\r\n    Slide,\r\n    Scale,\r\n    Fade,\r\n}\r\n\r\nfunction prop(type) {\r\n    if (type == AnimationType.Fade) {\r\n        return 'opacity'\r\n    } else if (type == AnimationType.Scale) {\r\n        return 'scale'\r\n    }\r\n    return 'position'\r\n}\r\n\r\n\r\n@ccclass(\"ShowConfig\")\r\nclass ShowConfig {\r\n    @property({ type: cc.Enum(AnimationType) })\r\n    type: AnimationType = AnimationType.Fade;\r\n    @property()\r\n    dur: number = 1;\r\n\r\n    @property()\r\n    from: number = 0;\r\n\r\n    @property()\r\n    to: number = 1;\r\n    @property({ type: cc.Enum(EaseType) })\r\n    easeType: EaseType = EaseType.linear;\r\n\r\n    @property({ type: cc.Vec2, visible() { return this.type == AnimationType.Slide } })\r\n    slideBy: cc.Vec2 = cc.v2();\r\n\r\n}\r\n\r\n@ccclass\r\nexport default class FourComics extends cc.Component {\r\n    cells: cc.Node[] = []\r\n    cursor: number = 0;\r\n\r\n    @property([ShowConfig])\r\n    configs: ShowConfig[] = []\r\n\r\n    @property([cc.Component.EventHandler])\r\n    onFinishes: cc.Component.EventHandler[] = [];\r\n\r\n    @property\r\n    interval: number = 3;\r\n\r\n    onLoad() {\r\n        this.cells = this.node.children;\r\n        this.cursor = 0;\r\n        this.node.on(cc.Node.EventType.TOUCH_END, this.next, this);\r\n    }\r\n\r\n    start() {\r\n        this.prepare();\r\n        this.next();\r\n        this.schedule(this.next, this.interval)\r\n    }\r\n\r\n    next() {\r\n        if (this.cursor >= this.configs.length) {\r\n            return;\r\n        }\r\n        this.play()\r\n        this.cursor++;\r\n        if (this.cursor >= this.configs.length) {\r\n            this.unschedule(this.next);\r\n        }\r\n    }\r\n\r\n    prepare() {\r\n        this.cells.forEach((v, i) => {\r\n            let c = this.configs[i];\r\n            let pp = prop(c.type);\r\n            v[pp] = c.from;\r\n        })\r\n    }\r\n\r\n\r\n\r\n\r\n    play() {\r\n        let c = this.cursor\r\n        let cell = this.cells[c];\r\n        let config = this.configs[c];\r\n        let t: cc.Tween = null\r\n        if (config.type == AnimationType.Slide) {\r\n            let pos = cell.getPosition();\r\n            cell.setPosition(pos.x + config.slideBy.x, pos.y + config.slideBy.y)\r\n            t = cc.tween(cell).to(config.dur, { position: pos }, { easing: EaseType[config.easeType] });\r\n        } else if (config.type == AnimationType.Fade) {\r\n            t = cc.tween(cell).to(config.dur, { [prop(config.type)]: config.to * 255 }, { easing: EaseType[config.easeType] })\r\n        } else if (config.type == AnimationType.Scale) {\r\n            t = cc.tween(cell).to(config.dur, { [prop(config.type)]: config.to }, { easing: EaseType[config.easeType] })\r\n        }\r\n        if (c == this.cells.length - 1) {\r\n            t.delay(2.0).call(() => {\r\n                this.onFinishes.forEach(v => v.emit([this]))\r\n            }).start()\r\n        } else {\r\n            t.start();\r\n        }\r\n    }\r\n}\r\n"]}