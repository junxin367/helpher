{"version":3,"sources":["assets\\Game\\Scripts\\Portal.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import RoleLoader from \"./RoleLoader\";\n\nlet { ccclass, property } = cc._decorator\n@ccclass\nexport default class ItemPortal extends cc.Component { // 传送门\n\n    // anim: cc.Animation = null\n\n    // collider: cc.PhysicsCollider = null;\n\n    @property(cc.Node)\n    anotherDoor: cc.Node = null;\n\n    isTransfer: boolean = false;\n\n    targetDoorNode: cc.Node = null\n\n    targetPortal: ItemPortal = null;\n\n    targetPortalCollider: cc.Collider = null;\n    self_collider: cc.Collider = null;\n    isEndContact: boolean = true;\n\n    fx: cc.ParticleSystem;\n\n    endContactNumber: number = 0;\n\n    onLoad() {\n\n    }\n\n    start() {\n        this.targetDoorNode = this.anotherDoor.getComponent(RoleLoader).self_door;\n        this.fx = this.getComponentInChildren(cc.ParticleSystem);\n        this.targetPortal = this.targetDoorNode.getComponent(ItemPortal);\n        this.targetPortalCollider = this.targetPortal.getComponent(cc.Collider);\n        this.self_collider = this.getComponent(cc.Collider);\n    }\n\n    go(node: cc.Node) {\n        this.scheduleOnce(_ => {\n            cc.tween(node).to(0.5, { opacity: 0 }).call(() => {\n                let pos = this.targetDoorNode.getPosition();\n                node.setPosition(pos.x, pos.y);\n            }).to(0.5, { opacity: 255 }).start();\n        }, 0);\n    }\n\n\n    onBeginContact(contact: cc.PhysicsContact, self, other: cc.PhysicsCollider) {\n        if (this.isTransfer || !this.isEndContact) return;\n        this.isTransfer = true;\n        this.go(other.node);\n        this.fx.resetSystem();\n        this.targetPortal.isTransfer = true;\n        this.targetPortal.fx.resetSystem();\n        this.scheduleOnce(() => {\n            this.isTransfer = false;\n            this.targetPortal.isTransfer = false;\n        }, 2)\n        this.isEndContact = false;\n    }\n\n    onEndContact(contact: cc.PhysicsContact, self, other: cc.PhysicsCollider) {\n        this.endContactNumber += 1;\n        if (this.endContactNumber >= 3) {\n            this.endContactNumber = 0;\n            this.isEndContact = true;\n        }\n    }\n}"]}