{"version":3,"sources":["assets\\Game\\Scripts\\Levels\\Effect.ts"],"names":[],"mappings":";;;;;;AAAA,mEAA8D;AAC9D,gCAA2B;AAC3B,uDAAoD;AACpD,sCAAiC;AACjC,8CAAyC;AACzC,8CAAyC;AACzC,oDAA+C;AAC/C,gCAA2B;AAC3B,mEAA2D;AAG3D;IAAA;IAmDA,CAAC;IAlDU,iBAAU,GAAjB,UAAkB,KAAW;QAAX,sBAAA,EAAA,WAAW;QACzB,0CAA0C;QAC1C,IAAI,GAAG,GAAG,qBAAW,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC,GAAG,CAAC,kBAAkB,CAAC,CAAA;QACzD,GAAG,CAAC,QAAQ,GAAG,EAAE,CAAC,EAAE,CAAC,CAAC,EAAE,GAAG,EAAE,CAAC,CAAC,CAAC;QAChC,GAAG,CAAC,MAAM,GAAG,cAAI,CAAC,IAAI,CAAC,IAAI,CAAC;QAC5B,IAAI,IAAI,GAAG,GAAG,CAAC,YAAY,CAAC,EAAE,CAAC,SAAS,CAAC,CAAA;QACzC,IAAI,CAAC,IAAI,EAAE,CAAC;QACZ,WAAG,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC,IAAI,CAAC,UAAA,CAAC;YACnB,qBAAW,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC;QACrC,CAAC,CAAC,CAAA;QACF,8BAA8B;QAC9B,KAAK;IACT,CAAC;IAEM,gBAAS,GAAhB;QACI,gBAAgB;QAChB,IAAI,KAAK,GAAG,EAAE,CAAC,QAAQ,CAAC,QAAQ,EAAE,CAAC,uBAAuB,CAAC,kBAAQ,CAAC,CAAA;QACpE,MAAM,CAAC,UAAU,EAAE,CAAC;QACpB,KAAK,CAAC,OAAO,CAAC,UAAA,CAAC;YACX,CAAC,CAAC,iBAAiB,CAAC,qBAAW,CAAC,CAAC;QACrC,CAAC,CAAC,CAAA;IACN,CAAC;IAEM,sBAAe,GAAtB;QACI,IAAI,MAAM,GAAG,cAAI,CAAC,QAAQ,CAAC,IAAI,CAAC;QAChC,wBAAwB;QACxB,IAAI,iBAAO,CAAC,UAAU,CAAC,MAAM,IAAI,CAAC,EAAE;YAChC,oBAAK,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;YACpB,OAAO,KAAK,CAAC;SAChB;QAED,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,iBAAO,CAAC,UAAU,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;YAChD,IAAI,CAAC,GAAG,iBAAO,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC;YAC9B,IAAI,CAAC,aAAa,CAAC,CAAC,EAAE,MAAM,CAAC,CAAC;SACjC;QACD,OAAO,IAAI,CAAC;IAChB,CAAC;IAEc,oBAAa,GAA5B,UAA6B,MAAe,EAAE,MAAM;QAChD,IAAI,GAAG,GAAG,cAAI,CAAC,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC;QAClC,EAAE,CAAC,SAAS,CAAC,IAAI,CAAC,yBAAyB,EAAE,EAAE,CAAC,MAAM,EAAE,UAAC,GAAG,EAAE,GAAG;YAC7D,IAAI,IAAI,GAAG,EAAE,CAAC,WAAW,CAAC,GAAG,CAAY,CAAA;YACzC,IAAI,KAAK,GAAG,IAAI,CAAC,YAAY,CAAC,kBAAQ,CAAC,CAAC;YACxC,KAAK,CAAC,MAAM,GAAG,MAAM,CAAC,IAAI,CAAC;YAC3B,IAAI,CAAC,MAAM,GAAG,MAAM,CAAC;YACrB,GAAG,CAAC,OAAO,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,EAAE,EAAE,EAAE,CAAC,CAAC,CAAC,CAAA;YAC5B,IAAI,CAAC,QAAQ,GAAG,GAAG,CAAA;QACvB,CAAC,CAAC,CAAA;IACN,CAAC;IAEL,aAAC;AAAD,CAnDA,AAmDC,IAAA","file":"","sourceRoot":"/","sourcesContent":["import PoolManager from \"../../../framework/core/PoolManager\";\r\nimport Role from \"../Role\";\r\nimport { evt } from \"../../../framework/core/event\";\r\nimport AIEnemy from \"../AIEnemy\";\r\nimport SnowBall from \"../items/SnowBall\";\r\nimport ItemStar from \"../items/ItemStar\";\r\nimport FlyToMagnet from \"../items/FlyToMagnet\";\r\nimport Game from \"../Game\";\r\nimport { Toast } from \"../../../framework/ui/ToastManager\";\r\nimport { UserInfo } from \"../../../framework/extension/weak_net_game/UserInfo\";\r\n\r\nexport default class Effect {\r\n    static showMagnet(delay = 1.0) {\r\n        // add a megnet over the head of the girl \r\n        let mag = PoolManager.get(\"Pool\").get(\"magnet-indicator\")\r\n        mag.position = cc.v3(0, 200, 0);\r\n        mag.parent = Role.self.node;\r\n        let anim = mag.getComponent(cc.Animation)\r\n        anim.play();\r\n        evt.sleep(delay).then(v => {\r\n            PoolManager.get(\"Pool\").put(mag);\r\n        })\r\n        // anim.on('finished', () => {\r\n        // })\r\n    }\r\n\r\n    static do_magnet() {\r\n        //find all stars\r\n        let stars = cc.director.getScene().getComponentsInChildren(ItemStar)\r\n        Effect.showMagnet();\r\n        stars.forEach(v => {\r\n            v.getOrAddComponent(FlyToMagnet);\r\n        })\r\n    }\r\n\r\n    static throw_snowballs() {\r\n        let parent = Game.instance.node;\r\n        // play throw animation \r\n        if (AIEnemy.allEnemies.length <= 0) {\r\n            Toast.make(\"未发现敌人\");\r\n            return false;\r\n        }\r\n\r\n        for (var i = 0; i < AIEnemy.allEnemies.length; i++) {\r\n            let e = AIEnemy.allEnemies[i];\r\n            this.addTargetBall(e, parent);\r\n        }\r\n        return true;\r\n    }\r\n\r\n    private static addTargetBall(enemey: AIEnemy, parent) {\r\n        let pos = Role.self.node.position;\r\n        cc.resources.load(\"Prefabs/effect/snowball\", cc.Prefab, (err, res) => {\r\n            let node = cc.instantiate(res) as cc.Node\r\n            let skill = node.getComponent(SnowBall);\r\n            skill.target = enemey.node;\r\n            node.parent = parent;\r\n            pos.addSelf(cc.v3(0, 80, 0))\r\n            node.position = pos\r\n        })\r\n    }\r\n\r\n}"]}