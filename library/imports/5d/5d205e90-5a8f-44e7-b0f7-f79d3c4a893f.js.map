{"version":3,"sources":["assets\\framework\\extension\\wxsdk\\WxGameClubButton.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["const { ccclass, property, menu } = cc._decorator;\r\nlet wxSysInfo\r\n@ccclass\r\n@menu(\"Wxsdk/WxGameClubButton\")\r\nexport default class WxGameClubButton extends cc.Component {\r\n\r\n    @property(cc.Component.EventHandler)\r\n    handler: cc.Component.EventHandler = new cc.Component.EventHandler();\r\n    button: any = null;\r\n\r\n    @property\r\n    width: number = 200;\r\n    @property\r\n    height: number = 40;\r\n    static instance: WxGameClubButton = null\r\n    onLoad() {\r\n        WxGameClubButton.instance = this;\r\n    }\r\n\r\n    onEnable() {\r\n        this.button && this.button.show();\r\n    }\r\n\r\n    onDisable() {\r\n        this.button && this.button.hide();\r\n    }\r\n\r\n    onDestroy() {\r\n        this.button && this.button.destroy();\r\n        WxGameClubButton.instance = null;\r\n    }\r\n\r\n    private createButton(callback) {\r\n        if (!wxSysInfo) {\r\n            wxSysInfo = wx.getSystemInfoSync();\r\n        }\r\n        var leftPos = wxSysInfo.windowWidth * 0.5 - this.width / 2\r\n        var topPos = wxSysInfo.windowHeight * 0.5 - this.height / 2\r\n        var width = this.width\r\n        var height = this.height\r\n        if (this.button) {\r\n            this.button.destroy()\r\n        }\r\n        var btnRect = this.node.getBoundingBoxToWorld()\r\n        var ratio = cc.view.getDevicePixelRatio();\r\n        var scale = cc.view.getScaleX()\r\n        var factor = scale / ratio\r\n        leftPos = btnRect.x * factor\r\n        topPos = wxSysInfo.screenHeight - (btnRect.y + btnRect.height) * factor\r\n        width = btnRect.width * factor\r\n        height = btnRect.height * factor\r\n        this.button = wx.createGameClubButton({\r\n            //green,white,dark , light\r\n            icon: 'light',\r\n            style: {\r\n                left: leftPos,\r\n                top: topPos,\r\n                width: width,\r\n                height: height,\r\n            }\r\n        });\r\n        this.button.onTap((res) => {\r\n            if (res) {\r\n                if (callback) callback(res);\r\n            } else if (callback) callback(null);\r\n        });\r\n    }\r\n\r\n    start() {\r\n        if (CC_WECHATGAME) {\r\n            this.createButton(res => {\r\n                this.handler.emit([res])\r\n            })\r\n\r\n        }\r\n    }\r\n}"]}