{"version":3,"sources":["assets\\framework\\extension\\shooter\\SGameEntity.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import ShootManager from \"./ShootManager\";\r\nimport MoveEngine from \"../movement/MoveEngine\";\r\n\r\nimport FSM from \"../../core/FSM\";\r\nimport Signal from \"../../core/Signal\";\r\nimport PsFxPlayer from \"../../misc/PsFxPlayer\";\r\n\r\nconst { ccclass, property, requireComponent, menu } = cc._decorator;\r\n\r\n\r\nexport enum EntityState {\r\n    Default,\r\n    Run,\r\n    Dead,\r\n    Disapear,\r\n    Remove,\r\n}\r\n\r\nenum VisibleState {\r\n    Invalid,\r\n    Check,\r\n    Visible,\r\n    Invisible\r\n}\r\n\r\nenum EntityEvent {\r\n    Dead,  //被 干死\r\n    Remove,//自动remove \r\n    Appear, // 第一次出现在屏幕 ,\r\n    Active, //激活 \r\n    Disapear, //消失在屏幕外\r\n    Hurt, //\r\n    HpChanged,\r\n}\r\n\r\n\r\n// enum ActiveEvent {\r\n//     None,\r\n//     PlayerDistance,\r\n//     Visible,\r\n//     CameraDistance,// invalid \r\n//     Start,\r\n// }\r\n\r\nenum DeletePolicy {\r\n    RemoveNode,\r\n    Destroy,\r\n}\r\n\r\nenum DeadDeletePolicy {\r\n    DontDelete,\r\n    Delete,\r\n    DelayDelete,\r\n}\r\n\r\n@ccclass\r\n@menu(\"shooter/GameEntity\")\r\nexport default class GameEntity extends cc.Component {\r\n\r\n    public uid: number = 0;\r\n\r\n    /** 最大hp值  */\r\n    @property({ displayName: \"最大生命值\" })\r\n    mHp: number = 10;\r\n\r\n    @property({ displayName: \"伤害值\" })\r\n    damage: number = 10;\r\n\r\n    // @property({ type: cc.Enum(ActiveEvent), displayName: \"激活方式\" })\r\n    // activeType: ActiveEvent = ActiveEvent.Start;\r\n\r\n    // @property({ visible: function () { return this.activeType != ActiveEvent.Start } })\r\n    // activeDistance: number = 0;\r\n\r\n    // @property({ displayName: \"延迟自动删除\", tooltip: \"-1 不自动删除 ,0 立刻删除 ，> 0 延迟删除\", min: -1 })\r\n    // autoDeleteDelay: number = -1;\r\n\r\n    // @property({ type: PsFxPlayer, displayName: \"删除特效\", visible() { return this.autoRemoveDelay > 0 } })\r\n    // deleteFx: PsFxPlayer;\r\n\r\n    /**死亡特效 */\r\n    deadFx: PsFxPlayer\r\n\r\n    @property({ displayName: \"看不见后删除\" })\r\n    invisibleDelete: boolean = false;\r\n\r\n    @property({ displayName: \"delay\", tooltip: \"看不见延迟删除时间\", visible() { return this.invisibleDelete } })\r\n    invisibleDeleteDelay: number = 0;\r\n\r\n    // @property({ displayName: \"一直显示\", tooltip: \"正常只有active 状态才会显示。勾上后会一直显示\" })\r\n    // alwasyShow: boolean = false;\r\n\r\n    @property({ type: cc.Enum(DeletePolicy), displayName: \"删除方式\" })\r\n    deletePolicy: DeletePolicy = DeletePolicy.RemoveNode;\r\n\r\n\r\n    @property({ displayName: \"死亡后删除策略\", type: cc.Enum(DeadDeletePolicy) })\r\n    deadDeletePolicy: DeadDeletePolicy = DeadDeletePolicy.Delete;\r\n\r\n    @property({ displayName: \"delay\", visible() { return this.deadDeletePolicy == DeadDeletePolicy.DelayDelete } })\r\n    deadDeleteDelay: number = 0;\r\n\r\n    /**移动引擎 */\r\n    moveEngine: MoveEngine\r\n    __fsm: FSM\r\n\r\n\r\n    // sprit: cc.Sprite;\r\n    fsm_visible: FSM\r\n    has_shown: boolean = false;\r\n    ps: cc.ParticleSystem[] = []\r\n    static Event: typeof EntityEvent = EntityEvent\r\n    static States: typeof EntityState = EntityState\r\n\r\n    /**当前值  */\r\n    private _hp: number = 0;\r\n\r\n    signals: Signal[] = []\r\n\r\n    sm: ShootManager = null;\r\n\r\n\r\n\r\n    onLoad() {\r\n        this.deadFx = this.getComponent(PsFxPlayer);\r\n        this.moveEngine = this.getComponent(MoveEngine)\r\n        this.ps = this.getComponentsInChildren(cc.ParticleSystem)\r\n\r\n        this.onInitFSM();\r\n\r\n        this.fsm_visible = this.addComponent(FSM);\r\n        this.fsm_visible.init(this);\r\n        this.fsm_visible.addStates(VisibleState);\r\n        this.fsm_visible.enterState(VisibleState.Check);\r\n    }\r\n\r\n    start() {\r\n        this.sm = ShootManager.instance\r\n\r\n    }\r\n\r\n    onInitFSM() {\r\n        let fsm = this.addComponent(FSM)\r\n        fsm.init(this);\r\n        fsm.addStates(EntityState);\r\n        fsm.enterState(EntityState.Default);\r\n        this.__fsm = fsm;\r\n    }\r\n\r\n\r\n\r\n\r\n    get isActive() {\r\n        if (this.__fsm == null) {\r\n            return console.warn(\"Have you foggot to call super.start or super.onLoad in inherit class which derived from GameEntity!\")\r\n        }\r\n        return this.__fsm.isInState(EntityState.Run);\r\n    }\r\n\r\n    set isActive(v) {\r\n        if (v) {\r\n            this.run()\r\n        } else {\r\n            this.stopRun();\r\n        }\r\n\r\n    }\r\n\r\n    onEnable() {\r\n        this._hp = this.mHp;\r\n        this.suicide = false;\r\n        this.node.angle = 0;\r\n        this.run();\r\n    }\r\n\r\n    onDisable() {\r\n        this.clear();\r\n    }\r\n\r\n\r\n    set hp(hp: number) {\r\n        let old = this._hp;\r\n        if (hp > this.maxHp) return;\r\n        if (old != hp) {\r\n            this._hp = hp;\r\n            this.emitEvents(EntityEvent.HpChanged, hp, old);\r\n            this.onHpChanged(this._hp, old)\r\n        }\r\n    }\r\n\r\n    set maxHp(hp) {\r\n        this.mHp = hp\r\n    }\r\n\r\n    get maxHp() {\r\n        return this.mHp\r\n    }\r\n\r\n    get hp() {\r\n        return this._hp;\r\n    }\r\n\r\n    respawn(bupdate?) {\r\n        if (bupdate) {\r\n            this.hp = this.maxHp\r\n        } else {\r\n            this._hp = this.maxHp;\r\n        }\r\n        //重新激活\r\n        this.isActive = true;\r\n    }\r\n\r\n    isDead() {\r\n        return this._hp <= 0;\r\n    }\r\n\r\n    //--------------------------------------interface----------------------------------------//\r\n    onHpChanged(hp, prev) { }\r\n    onDead() { }\r\n    onDelete() { }\r\n    onActive(state) { }\r\n    canHurt(reason) { return true; }\r\n    //------------------------------------------------------------------------------//\r\n\r\n    decreaseHp(hp, reason?) {\r\n        if (this.hp == 0) return;\r\n        if (!this.canHurt(reason)) return;\r\n        this.hp -= hp;\r\n        this.emitEvents(EntityEvent.Hurt, this.hp, hp);\r\n        if (this.hp <= 0) {\r\n            this.hp = 0;\r\n            if (this.__fsm.isInState(EntityState.Dead)) {\r\n                return\r\n            }\r\n            this.__fsm.changeState(EntityState.Dead);\r\n        }\r\n    }\r\n\r\n\r\n    run() {\r\n\r\n        this.__fsm.changeState(EntityState.Run);\r\n    }\r\n\r\n    stopRun() {\r\n        this.__fsm.changeState(EntityState.Default);\r\n    }\r\n    //------------------------------------------------------------------------------//\r\n\r\n    onEnter_CheckState(state) { }\r\n    onExit_CheckState(state) { }\r\n    onUpdate_CheckState(state, dt: number) {\r\n        if (this.sm.canSee(this.node)) {\r\n            this.fsm_visible.changeState(VisibleState.Visible)\r\n        } else {\r\n            this.fsm_visible.changeState(VisibleState.Invisible)\r\n        }\r\n    }\r\n\r\n\r\n    onEnter_VisibleState(state) {\r\n        if (this.has_shown == false) {\r\n            this.emitEvents(EntityEvent.Appear, this);\r\n        }\r\n        this.has_shown = true;\r\n    }\r\n\r\n    onUpdate_VisibleState(state, dt: number) {\r\n        if (!this.sm.canSee(this.node)) {\r\n            this.fsm_visible.changeState(VisibleState.Invisible)\r\n        }\r\n    }\r\n\r\n    onUpdate_InvisibleState(state, dt: number) {\r\n        if (this.has_shown) {\r\n            if (this.invisibleDelete) {\r\n                if (this.fsm_visible.timeElapsed > this.invisibleDeleteDelay) {\r\n                    this.__fsm.changeState(EntityState.Disapear);\r\n                    return;\r\n                }\r\n            }\r\n        }\r\n        if (this.sm.canSee(this.node)) {\r\n            this.fsm_visible.changeState(VisibleState.Visible)\r\n        }\r\n    }\r\n\r\n    //------------------------------------------------------------------------------//\r\n\r\n    checkVisible() {\r\n        if (this.fsm_visible.isInState(VisibleState.Visible)) {\r\n            this.run();\r\n        }\r\n    }\r\n\r\n    onEnter_DefaultState(state) {\r\n    }\r\n\r\n    onUpdate_DefaultState(state, dt: number) {\r\n        // switch (this.activeOn) {\r\n        //     case ActiveEvent.Visible:\r\n        //         this.checkVisible()\r\n        //         break;\r\n        //     case ActiveEvent.PlayerDistance:\r\n        //         this.checkInDistance(this.sm.player);\r\n        //         break;\r\n        // }\r\n    }\r\n\r\n\r\n    onEnter_RunState(state) {\r\n        this.onActive(state);\r\n        this.emitEvents(EntityEvent.Active, this);\r\n        this.ps.forEach(p => p.resetSystem())\r\n    }\r\n\r\n    onUpdate_RunState(state, dt) {\r\n        if (this.moveEngine) {\r\n            this.moveEngine.step(dt);\r\n        }\r\n        // if (this.autoDeleteDelay != -1) {\r\n        //     if (this.__fsm.timeElapsed >= this.autoDeleteDelay) {\r\n        //         this.__fsm.changeState(EntityState.Remove)\r\n        //     }\r\n        // }\r\n    }\r\n\r\n    onEnter_DeadState(state, extdeadFx: PsFxPlayer) {\r\n        // if (this.sprit)\r\n        //     this.sprit.enabled = false;\r\n        this.ps.forEach(p => p.stopSystem())\r\n        if (extdeadFx) {\r\n            extdeadFx.play().then(_ => {\r\n                if (this.deadDeletePolicy != DeadDeletePolicy.DontDelete) {\r\n                    this.__fsm.changeState(EntityState.Default);\r\n                }\r\n            })\r\n        } else {\r\n            if (this.deadFx) {\r\n                this.deadFx.play().then(_ => {\r\n                    //死亡效果 播放完成后删除\r\n                    if (this.deadDeletePolicy != DeadDeletePolicy.DontDelete) {\r\n                        this.__fsm.changeState(EntityState.Default);\r\n                    }\r\n                })\r\n            }\r\n        }\r\n        this.clear();\r\n        this.emitDeadEvents();\r\n    }\r\n\r\n    onUpdate_DeadState() {\r\n        if (this.deadDeletePolicy == DeadDeletePolicy.DelayDelete) {\r\n            if (this.__fsm.timeElapsed > this.deadDeleteDelay) {\r\n                this.__fsm.changeState(EntityState.Default)\r\n            }\r\n        } else if (this.deadDeletePolicy == DeadDeletePolicy.Delete) {\r\n            this.__fsm.changeState(EntityState.Default)\r\n        }\r\n    }\r\n\r\n    onExit_DeadState(state) {\r\n        //删除\r\n        this.doDelete()\r\n    }\r\n\r\n    clear() {\r\n        this.has_shown = false;\r\n        if (this.fsm_visible)\r\n            this.fsm_visible.changeState(VisibleState.Check)\r\n        if (this.moveEngine)\r\n            this.moveEngine.reset();\r\n    }\r\n\r\n    doDelete() {\r\n        if (this.deadDeletePolicy == DeadDeletePolicy.DontDelete) {\r\n            this.onDelete();\r\n        } else {\r\n            if (this.deletePolicy == DeletePolicy.RemoveNode) {\r\n                this.node.removeFromParent();\r\n            } else {\r\n                this.node.destroy();\r\n            }\r\n            this.onDelete();\r\n        }\r\n\r\n    }\r\n\r\n\r\n    onDestroy() {\r\n        this.signals.forEach(v => v.clear());\r\n    }\r\n\r\n\r\n    onEnter_DisapearState(state) {\r\n        // console.log(\"remove  \"+this.name)\r\n        this.clear();\r\n        this.doDelete()\r\n    }\r\n    onExit_DisapearState(state) { }\r\n    onUpdate_DisapearState(state, dt: number) { }\r\n\r\n\r\n\r\n    emitDeadEvents() {\r\n        this.onDead();\r\n        this.emitEvents(EntityEvent.Dead, this)\r\n    }\r\n\r\n    on(evt: EntityEvent | string, callback: Function, target: any) {\r\n        let signal = this.getEventSignal(evt)\r\n        signal.add(callback, target);\r\n    }\r\n\r\n    off(evt: EntityEvent | string, c: Function, t: any) {\r\n        let signal = this.getEventSignal(evt)\r\n        signal.remove(c, t);\r\n    }\r\n\r\n    getEventSignal(evt) {\r\n        let signal = this.signals[evt]\r\n        if (signal == null) {\r\n            signal = new Signal();\r\n            this.signals[evt] = signal;\r\n        }\r\n        return signal;\r\n    }\r\n\r\n    emitEvents(evt: EntityEvent | string, ...ps) {\r\n        let signal = this.getEventSignal(evt)\r\n        signal.fire(...ps);\r\n    }\r\n\r\n    suicide: boolean = false;\r\n\r\n    kill(deadFx: PsFxPlayer = null) {\r\n        this._hp = 0;\r\n        this.suicide = true;\r\n        this.__fsm.changeState(EntityState.Dead, deadFx)\r\n    }\r\n\r\n    remove() {\r\n        this.doDelete();\r\n    }\r\n\r\n\r\n    /**默认有碰撞 */\r\n    onCollisionEnter(other: cc.Collider, self) {\r\n        if (!this.isActive) return;\r\n        let entity = other.getComponent(GameEntity)\r\n        if (entity == null) {\r\n            entity = other.getComponentInParent(GameEntity);\r\n        }\r\n        if (entity) {\r\n            if (entity.isActive) {\r\n                entity.decreaseHp(this.damage, this)\r\n                this.decreaseHp(entity.damage, entity)\r\n                // this.onHitEntity(entity, other)\r\n            }\r\n        }\r\n    }\r\n\r\n}\r\n"]}