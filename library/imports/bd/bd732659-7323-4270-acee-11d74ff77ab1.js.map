{"version":3,"sources":["assets\\framework\\misc\\PasrTimer.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["// PasrTimer\r\nexport class PasrTimer {\r\n    private stage: number = 0;\r\n\r\n    private stageTime: number[] = [];\r\n\r\n    private timer: number = 0;\r\n\r\n    private value: number = 0;\r\n\r\n    private queriedSustain: boolean = false;\r\n\r\n    private queriedRelease: boolean = false;\r\n\r\n    private queriedFinished: boolean = false;\r\n\r\n    public constructor(pause: number = 0, attack: number = 0, sustain: number = 0, release: number = 0) {\r\n        this.stageTime = new Array\r\n        this.stageTime[0] = pause;\r\n        this.stageTime[1] = attack;\r\n        this.stageTime[2] = sustain;\r\n        this.stageTime[3] = release;\r\n        this.stage = 4;\r\n        this.queriedFinished = true;\r\n    }\r\n\r\n    set p(v) {\r\n        this.stageTime[0] = v;\r\n    }\r\n\r\n    get p() {\r\n        return this.stageTime[0]\r\n    }\r\n\r\n    set a(v) {\r\n        this.stageTime[1] = v;\r\n    }\r\n\r\n    get a() {\r\n        return this.stageTime[1]\r\n    }\r\n\r\n    set s(v) {\r\n        this.stageTime[2] = v;\r\n    }\r\n\r\n    get s() {\r\n        return this.stageTime[2]\r\n    }\r\n\r\n    set r(v) {\r\n        this.stageTime[3] = v;\r\n    }\r\n\r\n    get r() {\r\n        return this.stageTime[3]\r\n    }\r\n\r\n\r\n\r\n    public setStateTime(timeIndex, time) {\r\n        this.stageTime[timeIndex] = time;\r\n    }\r\n\r\n    public Tick(deltaTime: number): number {\r\n        if (this.stage == 4) {\r\n            this.value = 0;\r\n            return 0;\r\n        }\r\n        while (this.stage < 4 && (this.timer >= 1 || this.stageTime[this.stage] == 0)) {\r\n            this.timer = 0;\r\n            this.stage++;\r\n        }\r\n        if (this.stage < 4) {\r\n            this.timer += deltaTime / this.stageTime[this.stage];\r\n            if (this.timer > 1) {\r\n                this.timer = 1;\r\n            }\r\n        }\r\n        if (this.stage == 0) {\r\n            this.value = 0;\r\n        }\r\n        else if (this.stage == 1) {\r\n            this.value = this.timer;\r\n        }\r\n        else if (this.stage == 2) {\r\n            this.value = 1;\r\n        }\r\n        else if (this.stage == 3) {\r\n            this.value = 1 - this.timer;\r\n        }\r\n        else {\r\n            this.value = 0;\r\n        }\r\n        return this.value;\r\n    }\r\n\r\n    public GetValue(): number {\r\n        return this.value;\r\n    }\r\n\r\n    public reachedSustain(): boolean {\r\n        if (this.queriedSustain) {\r\n            return false;\r\n        }\r\n        if (this.stage >= 2) {\r\n            this.queriedSustain = true;\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n\r\n    public reachedRelease(): boolean {\r\n        if (this.queriedRelease) {\r\n            return false;\r\n        }\r\n        if (this.stage >= 3) {\r\n            this.queriedRelease = true;\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n\r\n    public isFinished(): boolean {\r\n        return this.stage == 4;\r\n    }\r\n\r\n    public reachedFinished(): boolean {\r\n        if (this.stage == 4 && !this.queriedFinished) {\r\n            this.queriedFinished = true;\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n\r\n    public reset(): void {\r\n        this.stage = 0;\r\n        this.timer = 0;\r\n        this.value = 0;\r\n        this.queriedSustain = false;\r\n        this.queriedFinished = false;\r\n    }\r\n\r\n    public Stop(): void {\r\n        this.stage = 4;\r\n    }\r\n\r\n    public GetStage(): number {\r\n        return this.stage;\r\n    }\r\n\r\n    public SetStage(stage: number): void {\r\n        this.stage = stage;\r\n        this.timer = 0;\r\n    }\r\n\r\n    public TotalTime(): number {\r\n        return this.stageTime[0] + this.stageTime[1] + this.stageTime[2] + this.stageTime[3];\r\n    }\r\n}\r\n"]}