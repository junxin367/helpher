{"version":3,"sources":["assets\\Game\\Scripts\\UI\\wxRankList.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["let Consts = {\n    OpenDataKeys: {\n        InitKey: \"initKey\",\n        Grade: \"testkey\",\n        LevelKey: \"reachlevel\",\n        ScoreKey: \"levelScore\", // json.string\n    },\n    DomainAction: {\n        FetchFriend: \"FetchFriend\",\n        FetchGroup: \"FetchGroup\",\n        FetchFriendLevel: \"FriendRank\", //好友排行\n        FetchChallengFriendLevel: \"FriendChallengRank\", //好友排行\n        FetchFriendDistance: \"FetchFriendDistance\", //好友关卡得分排行\n        HorConmpar: \"HorConmpar\", //横向比较 horizontal comparison\n        Paging: \"Paging\",\n        EndRank: \"EndRank\",//胜利界面排行\n        EndChallengRank: \"EndChallengRank\",//胜利界面排行\n        Scrolling: \"Scrolling\"\n    },\n}\n\n// 这个换成自己的逻辑\nlet utils = {\n    curLevel: 1,\n    getScore: _ => { return 1 }\n}\n\n\nconst { ccclass, property } = cc._decorator;\n\n@ccclass\nexport default class wxRankList extends cc.Component {\n\n    static instance: wxRankList = null;\n\n    @property(cc.Sprite)\n    rankRender: cc.Sprite = null; // render spr\n    @property(cc.Node)\n    rankListNode: cc.Node = null;\n\n    // @property(cc.Node)\n    // horRankNode:cc.Node=null;\n\n    @property(cc.Node)\n    rankBgNode: cc.Node = null;\n\n\n    @property(cc.Node)\n    touchLayer: cc.Node = null;\n\n    // @property(Boolean)\n    enableScroll = true;//\n\n    _timeCounter = 0;\n    rendInterval = 0.5;//刷新排行画布间隔s\n\n    rankTexture: cc.Texture2D = null;\n    rankSpriteFrame: cc.SpriteFrame = null;\n    closeBackRank = 0; // 关闭后操作\n    // LIFE-CYCLE CALLBACKS:\n\n    onLoad() {\n        wxRankList.instance = this;\n\n        this._timeCounter = 0\n        this.rankTexture = new cc.Texture2D();\n        this.rankSpriteFrame = new cc.SpriteFrame();\n        this.resizeSharedCanvas(this.rankRender.node.width, this.rankRender.node.height)\n    }\n\n    // start() {\n    // }\n\n    update(dt) {\n        // this._timeCounter += dt\n        // if (this._timeCounter < this.rendInterval) return\n        // this._timeCounter = 0\n\n        this.updateRankList()\n    }\n\n    resizeSharedCanvas(width, height) {\n        if (!window[\"wx\"]) return;\n        let sharedCanvas = window[\"wx\"].getOpenDataContext().canvas\n        sharedCanvas.width = width\n        sharedCanvas.height = height\n        console.log(sharedCanvas)\n    }\n\n    changeRender(renderNode: cc.Node) {\n        if (renderNode.name === \"sprHorRank\") {\n            // this.horRankNode.active = true;\n            this.rankListNode.active = false;\n            this.rankBgNode.active = false\n        } else if (renderNode.name === \"sprRankList\") {\n            // this.horRankNode.active = false;\n            this.rankListNode.active = true;\n            this.rankBgNode.active = true\n        }\n        this.rankRender.node.width = renderNode.width\n        this.rankRender.node.height = renderNode.height\n        this.rankRender.node.position = renderNode.position\n        this.resizeSharedCanvas(renderNode.width, renderNode.height)\n    }\n\n    updateRankList() {\n        if (!window[\"wx\"]) return;\n        if (!this.rankTexture) return;\n        let sharedCanvas = window[\"wx\"].getOpenDataContext().canvas\n        this.rankTexture.initWithElement(sharedCanvas);\n        this.rankTexture.handleLoadedTexture();\n        this.rankSpriteFrame.setTexture(this.rankTexture);\n        this.rankRender.spriteFrame = this.rankSpriteFrame;\n    }\n\n    onEnable() {\n        this.touchLayer.active = true\n        if (this.enableScroll) {\n            this.rankRender.node.on(cc.Node.EventType.TOUCH_MOVE, this.onTouchMove, this)\n        }\n\n        // this.postMessage(Consts.DomainAction.FetchFriendLevel)\n    }\n\n    onDisable() {\n        if (this.enableScroll) {\n            this.rankRender.node.off(cc.Node.EventType.TOUCH_MOVE)\n        }\n    }\n\n\n    onPageUp() {\n        console.log(this)\n        this.postMessage(\"Paging\", -1)\n    }\n\n    onPageDown() {\n        this.postMessage(\"Paging\", 1)\n    }\n\n    onClose() {\n        if (this.closeBackRank === 1) {\n            this.closeBackRank = 0;\n            this.loadHorRank(utils.curLevel)\n            return\n        }\n        this.node.active = false;\n    }\n\n    onTouchMove(event) {\n        const deltaY = event.getDeltaY();\n        // console.log(\"rank touchmove:\", deltaY);\n        this.postMessage(\"Scrolling\", deltaY)\n    }\n\n    //获取关卡得分排行\n    loadLevelScoreRank() {\n        this.node.active = true;\n        this.touchLayer.active = true\n        this.onEnable()\n        this.changeRender(this.rankListNode)\n        this.postMessage(Consts.DomainAction.EndRank)\n    }\n\n    loadChallengLevelScoreRank() {\n        this.node.active = true;\n        this.touchLayer.active = true\n        this.onEnable()\n        this.changeRender(this.rankListNode)\n        this.postMessage(Consts.DomainAction.EndChallengRank)\n    }\n\n    //获取关卡进度排行\n    loadLevelOpenRank() {\n        this.node.active = true;\n        this.touchLayer.active = true\n        this.onEnable()\n        this.changeRender(this.rankListNode)\n        this.postMessage(Consts.DomainAction.FetchFriendLevel)\n    }\n    loadChallengLevelOpenRank() {\n        this.node.active = true;\n        this.touchLayer.active = true\n        this.onEnable()\n        this.changeRender(this.rankListNode)\n        this.postMessage(Consts.DomainAction.FetchChallengFriendLevel)\n    }\n\n    //横向比较\n    loadHorRank(level = 1) {\n        this.node.active = true;\n        this.touchLayer.active = false\n        this.onDisable()\n        // this.changeRender(this.horRankNode)\n        this.postMessage(Consts.DomainAction.HorConmpar, level, utils.getScore(level))\n    }\n\n\n    //向子域发送消息\n    postMessage(action, data = null, dataEx = null) {\n        if (!window[\"wx\"]) return;\n        let openDataContext = window[\"wx\"].getOpenDataContext()\n        openDataContext.postMessage({\n            action: action,\n            data: data,\n            dataEx: dataEx,\n        })\n    }\n\n    // //检查得分\n    // checkScore(key, callback){\n    //     if (!window.wx) return\n    //     wx.getUserCloudStorage({\n    //         keyList:[key],\n    //         success:res=>{\n    //             res.data.\n    //         }\n    //     })\n    // }\n\n    //wx api\n    // 上传关卡分数\n    uploadScore(level, score) {\n        if (!window[\"wx\"]) return;\n        score = score.toString()\n        window[\"wx\"].setUserCloudStorage({\n            KVDataList: [\n                { key: Consts.OpenDataKeys.ScoreKey + level, value: score },\n            ],\n            success: (res) => {\n                console.log(\"uploadScore success:res=>\", res)\n            },\n            fail: (res) => {\n                console.log(\"uploadScore fail:res=>\", res)\n            }\n        })\n    }\n\n    // 上传关卡开启进度\n    uploadLevelOpen(level) {\n        if (!window.window[\"wx\"]) return\n        level = level.toString()\n        window[\"wx\"].setUserCloudStorage({\n            KVDataList: [\n                { key: Consts.OpenDataKeys.LevelKey, value: level },\n            ],\n            success: (res) => {\n                console.log(\"uploadScore success:res=>\", res)\n            },\n            fail: (res) => {\n                console.log(\"uploadScore fail:res=>\", res)\n            }\n        })\n    }\n\n    //删除微信数据\n    removeUserKey(key_or_keys) {\n        if (!window.window[\"wx\"]) return\n        if (typeof (key_or_keys) === \"string\") {\n            key_or_keys = [key_or_keys]\n        }\n        window[\"wx\"].removeUserCloudStorage({\n            keyList: key_or_keys,\n            success: (res) => {\n                console.log(\"uploadScore success:res=>\", res)\n            },\n            fail: (res) => {\n                console.log(\"uploadScore fail:res=>\", res)\n            }\n        })\n    }\n\n    // 分享\n    /* args:{\n                title: string\n                imageUrl: string\n                query: string\n                success: func\n                fail: func\n            }\n    */\n    share(args) {\n        if (!window.window[\"wx\"]) return\n        if (!args) args = {}\n        args.imageUrl = args.imageUrl || \"http://img.zcool.cn/community/01c2ac57beb18d0000012e7eaa6d19.jpg@1280w_1l_2o_100sh.jpg\"\n        window[\"wx\"].shareAppMessage({\n            title: \"\",\n            // imageUrl: \"res/raw-assets/res/shengming.25929.png\",\n            imageUrl: args.imageUrl,\n            query: \"key=testshare\",\n            success: (res) => {\n                console.log(\"success:\", res)\n                if (args.success) {\n                    args.success(res)\n                }\n            },\n            fail: res => {\n                console.log(\"fail:\", res)\n                if (args.fail) {\n                    args.fail(res)\n                }\n            }\n        })\n    }\n\n    initRank() {\n    }\n\n    snapshotSync() {\n        if (!window['wx']) return\n        var canvas = cc.game.canvas;\n        var width = cc.winSize.width;\n        var height = cc.winSize.height;\n\n        return canvas['toTempFilePathSync']({\n            x: 0,\n            y: 0,\n            width: width * 1.5,\n            height: height,\n            destWidth: width * 1.5,\n            destHeight: height\n        })\n    }\n\n}\n"]}