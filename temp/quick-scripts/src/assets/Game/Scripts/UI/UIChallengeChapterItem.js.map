{"version":3,"sources":["assets\\Game\\Scripts\\UI\\UIChallengeChapterItem.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import mvcView from \"../../../framework/ui/mvcView\";\nimport { PlayerInfo } from \"../Common/Base/PlayerInfo\";\nimport { Toast } from \"../../../framework/ui/ToastManager\";\nimport LoadingScene from \"../Common/Base/LoadingScene\";\nimport WeakNetGame from \"../../../framework/extension/weak_net_game/WeakNetGame\";\nimport Platform from \"../../../framework/extension/Platform\";\nimport { ROW } from \"./UIChallengeChapter\";\n\nconst { ccclass, property } = cc._decorator;\n\n@ccclass\nexport default class UIChallengeChapterItem extends mvcView {\n    @property(cc.Label)\n    label_chapter: cc.Label = null;\n\n    @property(cc.Node)\n    level_node: cc.Node = null;\n\n    // _init: boolean = false;\n\n    onLoad() {\n        this.register(this.label_chapter, _ => this.showLabel());\n    }\n\n    onLaterRender() {\n        // if (!this._init) {\n        //     this._init = true;\n            this.refresh_level();\n        // }\n    }\n\n    refresh_level() {\n        let data = this.getData() as number;\n        let maxLevel = csv.daily_level.values.length;\n        for (let i = 0; i < this.level_node.children.length; i++) {\n            let level = ((data - 1) * ROW) + (i + 1);\n            this.onClick(this.level_node.children[i], _ => this.click_startGame(level));\n\n            let levelNow_node = this.level_node.children[i].getChildByName(\"dangqian\");\n\n            let t1_node = this.level_node.children[i].getChildByName(\"t1\");\n            t1_node.getComponent(cc.Label).string = ((data - 1) * 5 + i + 1) + \"\";\n\n            let unlock_node = this.level_node.children[i].getChildByName(\"weijisuo\");\n            if (level > PlayerInfo.dailylevel) {\n                unlock_node.active = true;\n            } else {\n                if (i == 4 && (PlayerInfo.challenge_gift.indexOf(data) == -1)) {\n                    this.level_node.children[i].getChildByName(\"kelingqu\").active = true;\n                    this.level_node.children[i].getChildByName(\"libao\").active = true;\n                    this.onClick(this.level_node.children[i].getChildByName(\"libao\"), _ => this.click_gift(data));\n                }\n                else if (i == 4) {\n                    this.level_node.children[i].getChildByName(\"libao\").active = false;\n                    this.level_node.children[i].getChildByName(\"kelingqu\").active = false;\n                }\n                unlock_node.active = false;\n            }\n\n            this.level_node.children[i].opacity = maxLevel < level ? 0 : 255;\n        }\n    }\n\n    showLabel() {\n        let data = this.getData() as number;\n        return `阶段${data}`;\n    }\n\n    click_gift(data) {\n        this.level_node.children[4].getChildByName(\"libao\").active = false;\n        this.level_node.children[4].getChildByName(\"kelingqu\").active = false;\n        vm.show(\"Prefabs/UI/UIGetGift\", data);\n    }\n\n    click_startGame(level) {\n        PlayerInfo.isPlayingDaily = true;\n        if (level > PlayerInfo.dailylevel) {\n            Toast.make(\"未解锁\")\n            return;\n        }\n        if (PlayerInfo.labour > 0) {\n            PlayerInfo.labour--;\n            if (PlayerInfo.isPlayingDaily) {\n                PlayerInfo.playingDailyLevel = level;\n\n                if ((csv.Config.Challenge_Level_Show_AD == PlayerInfo.playingDailyLevel) || (((PlayerInfo.playingDailyLevel - csv.Config.Challenge_Level_Show_AD) % csv.Config.Challenge_Level_Show_AD_Interval) == 0) && (PlayerInfo.playingDailyLevel > csv.Config.Challenge_Level_Show_AD)) {\n\n                    WeakNetGame.doChoice(\"SOV_ShowAD\", _ => {\n                        PlayerInfo.save();\n                        LoadingScene.goto(\"Game\");\n                    }, this);\n\n                } else if ((csv.Config.Challenge_Level_Show_AD_Skip == PlayerInfo.playingDailyLevel) || (((PlayerInfo.playingDailyLevel - csv.Config.Challenge_Level_Show_AD_Skip) % csv.Config.Challenge_Level_Show_AD_Skip_Interval) == 0) && (PlayerInfo.playingDailyLevel > csv.Config.Challenge_Level_Show_AD_Skip)) {\n\n                    Platform.showInterstitial(_ => {\n                        PlayerInfo.save();\n                        LoadingScene.goto(\"Game\");\n                    }, this);\n\n                }\n                else {\n                    PlayerInfo.save();\n                    LoadingScene.goto(\"Game\");\n                }\n            } else {\n                PlayerInfo.playinglevel = level;\n                PlayerInfo.save();\n                LoadingScene.goto(\"Game\");\n            }\n\n\n        } else {\n            // Toast.make(\"体力不足\");\n            vm.show(\"Prefabs/UI/UIGetLabour\", _ => {\n                PlayerInfo.labour--;\n                if (PlayerInfo.isPlayingDaily) {\n                    PlayerInfo.playingDailyLevel = level;\n                } else {\n                    PlayerInfo.playinglevel = level;\n                }\n                PlayerInfo.save();\n                LoadingScene.goto(\"Game\");\n            }, false);\n        }\n\n        // if(PlayerInfo.isNew)\n        //     StatHepler.userAction(\"(新玩家)进入关卡\",PlayerInfo.playinglevel)\n    }\n}\n"]}