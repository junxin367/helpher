{"version":3,"sources":["assets\\Game\\Scripts\\UI\\UIFriendHelp.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import Net, { net } from \"../../../framework/misc/Net\"\r\nimport { ServerConfig, Api } from \"../Common/Base/ServerConfig\"\r\nimport { UserInfo } from \"../../../framework/extension/weak_net_game/UserInfo\"\r\nimport mvcView from \"../../../framework/ui/mvcView\";\r\nimport ListView from \"../../../framework/ui/controller/ListView\";\r\nimport UIFriendHelpItem from \"./UIFriendHelpItem\";\r\nimport WeakNetGame from \"../../../framework/extension/weak_net_game/WeakNetGame\";\r\nimport UIDayInviteItem from \"./UIDayInviteItem\";\r\nimport { Toast } from \"../../../framework/ui/ToastManager\";\r\n\r\nlet { ccclass, property } = cc._decorator\r\nexport interface SumInvite {\r\n    openId, inviteeCount, claimedCount\r\n}\r\nexport interface DayInvite {\r\n    _id, openId, invitee, status, index, nickName, avatarUrl, count\r\n}\r\n\r\n@ccclass\r\nexport default class UIFriendHelp extends mvcView {\r\n\r\n    @property(cc.Layout)\r\n    layout: cc.Layout = null;\r\n\r\n    @property(ListView)\r\n    listview: ListView = null;\r\n\r\n    static sum_invite: SumInvite = null;\r\n    static day_invite: DayInvite[] = [];\r\n\r\n    onLoad() {\r\n        this.register(this.layout, v => UIFriendHelp.day_invite, this.setItem.bind(this))\r\n    }\r\n\r\n    start() {\r\n        this.listview.numItems = 0\r\n    }\r\n\r\n\r\n    setItem(node: cc.Node, data: DayInvite, i) {\r\n        let item = node.getComponent(UIDayInviteItem);\r\n        item.setData(data, i);\r\n    }\r\n\r\n    onShown() {\r\n        WeakNetGame.client.httpGet(Api.invite_get).then(v => {\r\n            if (v == Net.Code.Timeout) {\r\n                Toast.make(\"邀请信息读取失败!\")\r\n            } else {\r\n                if (v) {\r\n                    let d = JSON.parse(v);\r\n                    console.log(d);\r\n                    this.onRequested(d.data)\r\n                } else {\r\n                    Toast.make(\"服务器出错!\")\r\n                }\r\n            }\r\n        })\r\n    }\r\n\r\n    onRequested(data: any) {\r\n        UIFriendHelp.day_invite.splice(0)\r\n        for (var i = 0; i < 3; i++) {\r\n            let v = data.day_invite[i];\r\n            UIFriendHelp.day_invite.push(v)\r\n        }\r\n        UIFriendHelp.sum_invite = data.sum_invite;\r\n        if (UIFriendHelp.sum_invite.claimedCount == null) {\r\n            UIFriendHelp.sum_invite.claimedCount = 0;\r\n        }\r\n        this.render(data.day_items)\r\n        this.listview.numItems = 100;\r\n    }\r\n\r\n    onRender(node: cc.Node, index: number) {\r\n        let item = node.getComponent(UIFriendHelpItem);\r\n        item.setData(UIFriendHelp.sum_invite, index);\r\n    }\r\n\r\n\r\n    click_close() {\r\n        vm.hide(this);\r\n    }\r\n\r\n\r\n}"]}