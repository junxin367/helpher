{"version":3,"sources":["assets\\Game\\Scripts\\UI\\UIManual_Egg.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import mvcView from \"../../../framework/ui/mvcView\";\r\nimport { Toast } from \"../../../framework/ui/ToastManager\";\r\nimport { evt } from \"../../../framework/core/event\";\r\nimport Platform from \"../../../framework/extension/Platform\";\r\nimport { PlayerInfo } from \"../Common/Base/PlayerInfo\";\r\nimport display from \"../../../framework/misc/display\";\r\n\r\n\r\nlet { ccclass, property } = cc._decorator\r\n@ccclass\r\nexport default class UIManual_Egg extends mvcView {\r\n\r\n    @property(cc.ProgressBar)\r\n    Bar: cc.ProgressBar = null;\r\n\r\n    @property(cc.Animation)\r\n    egg_ani: cc.Animation = null;\r\n\r\n    @property(cc.ParticleSystem)\r\n    lizi: cc.ParticleSystem = null;\r\n\r\n    @property(cc.Node)\r\n    egg1: cc.Node = null;\r\n\r\n    \r\n    @property(cc.Node)\r\n    get_but: cc.Node = null;\r\n\r\n    state:cc.AnimationState\r\n\r\n    isleave: boolean = false;\r\n    isbanner: boolean = false;\r\n    isshowed: boolean = false;\r\n    isplay: boolean = false;\r\n    randomNum: number = 0;\r\n    view: string = \"\";\r\n\r\n    onLoad() {\r\n        this.egg_ani.on(cc.Animation.EventType.FINISHED, this.finsh,this)\r\n    }\r\n\r\n    onShow(view) {\r\n        evt.on(\"Game.Resume\", this.onResume, this);\r\n        this.Bar.progress = 0;\r\n        this.view = view;\r\n        this.randomNum = g.randomFloat(0.4,0.6);\r\n        // this.randomNum = (Math.floor(Math.random() * 3) + 4) / 10;\r\n        Platform.refreshBannerAd();\r\n        \r\n    }\r\n    onResume(){\r\n        Platform.hideBannerAd();\r\n    }\r\n\r\n    onDestroy() {\r\n        // this.egg_ani.off(cc.Animation.EventType.FINISHED, this.finsh,this)\r\n    }\r\n\r\n    async click_egg() {\r\n        // if (!this.isplay) {\r\n        //     this.isplay = true;\r\n        //     this.egg_ani.play();\r\n        // }\r\n        this.unschedule(this.reduce_propress);\r\n        this.Bar.progress += 0.1;\r\n        if (this.Bar.progress >= this.randomNum && !this.isshowed) {\r\n            this.isshowed = true;\r\n            this.egg1.y += 10;\r\n            // Platform.reloadBannerAd(true);\r\n            Platform.showBannerAd();\r\n            this.isbanner = true;\r\n            this.scheduleOnce(_ => {\r\n                if(cc.isValid(this)){\r\n                    this.isbanner = false;\r\n                    Platform.hideBannerAd();\r\n                }\r\n            }, 2)\r\n        }\r\n        if (this.Bar.progress >= 1) {\r\n            // this.lizi.resetSystem();\r\n            this.unscheduleAllCallbacks();\r\n            this.egg_ani.play(\"egg2\");\r\n            Toast.make(\"恭喜获得体力 1\");\r\n            evt.emit(\"Game.getTili\", display.center, 1);\r\n            PlayerInfo.labour += 1;\r\n            this.get_but.active = false;\r\n            return;\r\n            // await evt.sleep(1.5);\r\n            // vm.hide(this);\r\n            // if (this.view == \"win\") {\r\n            //     vm.show(\"Prefabs/UI/UIWin\");\r\n            // }\r\n            // else if (this.view == \"lose\") {\r\n            //     vm.show(\"Prefabs/UI/UILose\");\r\n            // }\r\n            \r\n        }\r\n        this.schedule(this.reduce_propress, 0, 1000, 0.5);\r\n    }\r\n\r\n    reduce_propress() {\r\n        if (this.isbanner) return;\r\n        this.Bar.progress -= 0.001;\r\n        if(this.Bar.progress <= 0){\r\n            this.unschedule(this.reduce_propress);\r\n            this.Bar.progress = 0;\r\n        }\r\n    }\r\n\r\n    onHide() {\r\n        evt.off(this);\r\n        Platform.hideBannerAd();\r\n        this.isbanner = false;\r\n        this.isleave = true;\r\n    }\r\n\r\n    finsh(){\r\n        console.log(\"动画结束\")\r\n        vm.hide(this);\r\n        if (this.view == \"win\") {\r\n            vm.show(\"Prefabs/UI/UIWin\");\r\n        }\r\n        else if (this.view == \"lose\") {\r\n            vm.show(\"Prefabs/UI/UILose\");\r\n        }            \r\n    }\r\n\r\n\r\n}"]}