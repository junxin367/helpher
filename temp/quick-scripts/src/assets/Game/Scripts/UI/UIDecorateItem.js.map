{"version":3,"sources":["assets\\Game\\Scripts\\UI\\UIDecorateItem.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import mvcView from \"../../../framework/ui/mvcView\";\r\nimport Switcher from \"../../../framework/ui/controller/Switcher\";\r\nimport { PlayerInfo } from \"../Common/Base/PlayerInfo\";\r\nimport { evt } from \"../../../framework/core/event\";\r\nimport { Toast } from \"../../../framework/ui/ToastManager\";\r\nimport { DecorateType } from \"./UIPersonSkin\";\r\n\r\nlet { ccclass, property } = cc._decorator\r\n\r\nenum StatusIndex {\r\n    Choosed = 0, // 已选择\r\n    Unlocked = 1, //已解锁\r\n    Locked = 2, //锁 \r\n}\r\n\r\nconst Choosed_Color = new cc.Color().fromHEX(\"#FFFBDA\")\r\nconst Name_Color = new cc.Color().fromHEX(\"#504B68\")\r\nconst Unlock_Color = new cc.Color().fromHEX(\"#82FF52\")\r\n\r\n@ccclass\r\nexport default class UIDecorateItem extends mvcView {\r\n\r\n    @property(cc.Label)\r\n    nameLabel: cc.Label = null;\r\n    @property(Switcher)\r\n    switcher: Switcher = null;\r\n\r\n    @property(cc.Sprite)\r\n    icon: cc.Sprite = null;\r\n\r\n    @property(cc.Button)\r\n    btn_select: cc.Button = null;\r\n\r\n\r\n    @property(cc.Button)\r\n    btn_unlock: cc.Button = null\r\n\r\n    @property(cc.Button)\r\n    btn_choosed: cc.Button = null;\r\n\r\n    @property(cc.Node)\r\n    redPoint: cc.Node = null;\r\n\r\n\r\n    onLoad() {\r\n        this.register<csv.Collection_Row>(this.switcher, (data) => {\r\n            this.node.color = cc.Color.WHITE;\r\n            this.btn_unlock.node.color = cc.Color.WHITE;\r\n            this.node.opacity = 255;\r\n            if (PlayerInfo.isDecorateUnlocked(data.id)) {\r\n                //已解锁 \r\n                if (PlayerInfo.isDecorateUsing(data.id)) {\r\n                    this.node.color = Choosed_Color;\r\n                    return StatusIndex.Choosed;\r\n                } else {\r\n                    return StatusIndex.Unlocked;\r\n                }\r\n            } else {\r\n                //未解锁 状态 \r\n                let unlock = this.canUnlock();\r\n                // ccUtil.setButtonEnabled(this.btn_unlock, unlock);\r\n                this.redPoint.active = unlock;\r\n                if (!unlock) {\r\n                    this.node.opacity = 222;\r\n                } else {\r\n                    this.btn_unlock.interactable = false;\r\n                    this.btn_unlock.node.color = Unlock_Color;\r\n                }\r\n                // this.nameLabel.node.color = cc.Color.RED;\r\n                return StatusIndex.Locked;\r\n            }\r\n        })\r\n\r\n        this.register<csv.Collection_Row>(this.nameLabel, (data) => {\r\n            return data.name;\r\n        })\r\n\r\n        this.register<csv.Collection_Row>(this.icon, (data) => {\r\n            cc.log(`${data.thumbnail}`);\r\n            return data.thumbnail ? \"Img/decorate/thumbnail/\" + data.thumbnail : '';\r\n        });\r\n\r\n        this.register(this.btn_unlock, this.click_unlock);\r\n        this.register(this.btn_select, this.click_select);\r\n        this.register(this.btn_choosed, this.click_choosed);\r\n    }\r\n\r\n    /**j是否可以解锁  */\r\n    canUnlock() {\r\n        return false;\r\n    }\r\n\r\n    unlock() {\r\n        let d: csv.Collection_Row = this.getData() as csv.Collection_Row;\r\n        PlayerInfo.unlockDecorate(d.id);\r\n        Toast.make(\"已解锁：\" + d.name);\r\n        this.render(d);\r\n    }\r\n\r\n    onvideocallback() {\r\n        this.unlock();\r\n    }\r\n\r\n    click_unlock() {\r\n        let data = this.getData() as csv.Collection_Row;\r\n        if (this.canUnlock()) {\r\n            PlayerInfo.unlockDecorate(data.id);\r\n            Toast.make(\"已解锁：\" + data.name);\r\n            evt.emit('UISkin.checkLock');\r\n            this.render(data);\r\n        }\r\n    }\r\n\r\n    click_select() {\r\n        let data = this.getData() as csv.Collection_Row;\r\n        if (PlayerInfo.isDecorateUnlocked(data.id)) {\r\n            PlayerInfo.useDecorate(data.id);\r\n            // this.render(data);\r\n            //选择需要 取消选择其它同类项目\r\n            evt.emit('Decorate.select', data)\r\n        }\r\n    }\r\n\r\n    click_choosed() {\r\n        let data = this.getData() as csv.Collection_Row;\r\n        if (data.type === DecorateType.BaiJian) {\r\n            PlayerInfo.collections[data.id] = 1;\r\n            PlayerInfo.save();\r\n            // this.render();\r\n            //选择需要 取消选择其它同类项目\r\n            evt.emit('Decorate.select', data)\r\n        }\r\n    }\r\n\r\n}"]}