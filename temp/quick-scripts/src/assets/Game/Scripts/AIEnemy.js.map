{"version":3,"sources":["assets\\Game\\Scripts\\AIEnemy.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import FSM from \"../../framework/core/FSM\";\r\nimport Role from \"./Role\";\r\nimport { evt } from \"../../framework/core/event\";\r\nimport SkeletonBase from \"./SkeletonBase\";\r\nimport Device from \"../../framework/misc/Device\";\r\nimport RemoveOutOfView from \"./RemoveOutOfView\";\r\nimport Bomb from \"./Bomb\";\r\nimport BombTooltip from \"./BombTooltip\";\r\nimport Game from \"./Game\";\r\n\r\nconst { ccclass, property } = cc._decorator;\r\n\r\n\r\nenum State {\r\n    //巡逻\r\n    Idle,\r\n    Seek,\r\n    //选择方向 \r\n    Judge,\r\n    //发现主角\r\n    Detected,\r\n    //追逐\r\n    Chase,\r\n    //抓到\r\n    Catch,\r\n    // \r\n    Freezed,\r\n    LoseTarget,\r\n    Dead,\r\n}\r\n\r\nenum FaceDir {\r\n    Left = 0,\r\n    Right = 1\r\n}\r\n\r\n\r\n@ccclass\r\nexport default class AIEnemy extends SkeletonBase {\r\n    @property({ type: cc.Enum(FaceDir) })\r\n    faceDir: FaceDir = FaceDir.Right;\r\n    //面向 \r\n    @property\r\n    private _dir = 1;\r\n    public get dir() {\r\n        return this._dir;\r\n    }\r\n    public set dir(value) {\r\n        this._dir = value;\r\n        let c = 1;\r\n        if (this.faceDir == FaceDir.Left) {\r\n            c = -1\r\n        }\r\n        if (this.bombTooltip)\r\n            this.bombTooltip.dir = value;\r\n        this.node.scaleX = this.baseScale * value * c;\r\n    }\r\n\r\n    static allEnemies: AIEnemy[] = []\r\n\r\n    baseScale: number = 0;\r\n    speed = 1;\r\n    fsm: FSM;\r\n\r\n    collider: cc.PhysicsCollider;\r\n\r\n    @property(cc.AudioClip)\r\n    detected_audio: cc.AudioClip = null;\r\n\r\n    @property(cc.AudioClip)\r\n    audio_bite: cc.AudioClip = null;\r\n\r\n    @property(cc.AudioClip)\r\n    audio_catched: cc.AudioClip = null;\r\n\r\n\r\n    /**进入休息时发出的声音 */\r\n    @property(cc.AudioClip)\r\n    audio_seek: cc.AudioClip = null;\r\n\r\n    anim: cc.Animation = null;\r\n\r\n    @property(cc.AudioClip)\r\n    audio_dead: cc.AudioClip = null;\r\n\r\n    @property(cc.AudioClip)\r\n    audio_walk: cc.AudioClip = null;\r\n\r\n    @property(cc.AudioClip)\r\n    audio_question: cc.AudioClip = null;\r\n\r\n    @property\r\n    dead_with_fall: boolean = false;\r\n\r\n    bomb: Bomb;\r\n\r\n    @property(BombTooltip)\r\n    bombTooltip: BombTooltip = null\r\n\r\n    start() {\r\n        AIEnemy.allEnemies.push(this);\r\n        this.fsm = this.addComponent(FSM);\r\n        this.fsm.init(this, State);\r\n        // this.fsm._log = true;\r\n        evt.on(\"Game.keyMoved\", this.onKeyMove, this);\r\n        evt.on(\"Game.bomb\", this.goDead, this);\r\n        this.fsm.enterState(State.Seek)\r\n        this.baseScale = this.node.scale;\r\n        this.collider = this.getComponent(cc.PhysicsCollider);\r\n        if (this.faceDir == FaceDir.Left) {\r\n            this._dir = -1\r\n        }\r\n        // this._dir = this.faceDir;\r\n        this.addComponent(RemoveOutOfView);\r\n        this.anim = this.getComponent(cc.Animation);\r\n\r\n        this.loseBomb();\r\n    }\r\n\r\n\r\n    onDestroy() {\r\n        if (this.bombTooltip && this.bombTooltip.node) {\r\n            this.bombTooltip.node.destroy();\r\n        }\r\n        evt.off(this);\r\n        let idx = AIEnemy.allEnemies.indexOf(this);\r\n        AIEnemy.allEnemies.splice(idx, 1)\r\n        this.removeBomb();\r\n\r\n\r\n    }\r\n\r\n    _world: cc.PhysicsManager;\r\n\r\n    set enableCollide(b) {\r\n        // if (b) {\r\n        this.collider.enabled = b;\r\n        this.collider.sensor = !b;\r\n        this.fsm.enabled = b;\r\n        this.fsm.pause()\r\n    }\r\n\r\n    removeBomb() {\r\n        if (this.bombTooltip && this.bombTooltip.node)\r\n            this.bombTooltip.node.active = false;\r\n        if (cc.isValid(this.bomb))\r\n            this.bomb.node.destroy();\r\n    }\r\n\r\n    onEnter_Seek(state) {\r\n        this.speed = 1\r\n        //射线检测  主角\r\n        state.setInterval(0.5, this.seek_l_r, this);\r\n        state.setInterval(2, this.needHavaRest, this)\r\n        this.playAnim(\"walk\")\r\n        if (this.audio_walk)\r\n            state.audio = Device.playEffect(this.audio_walk, true)\r\n    }\r\n\r\n    onExit_Seek(state) {\r\n        Device.stopEffect(state.audio);\r\n    }\r\n\r\n    onKeyMove() {\r\n        if (this.fsm.isInState(State.Seek) || this.fsm.isInState(State.Idle)) {\r\n            this.fsm.changeState(State.Judge);\r\n        }\r\n    }\r\n\r\n\r\n    seek_l_r() {\r\n        if (Game.instance.isOver) return;\r\n        if (!this.raycast(this.dir)) {\r\n            this.raycast(-this.dir);\r\n        }\r\n    }\r\n\r\n\r\n    onEnter_Judge() {\r\n        this.playAnim(\"idle\")\r\n        if (!this.raycast()) {\r\n            this.dir = -this.dir;\r\n            this.raycast();\r\n        }\r\n\r\n    }\r\n\r\n    onUpdate_Judge() {\r\n        if (this.fsm.timeElapsed > 0.5) {\r\n            this.fsm.changeState(State.Seek);\r\n        }\r\n    }\r\n\r\n\r\n    onExit_Judge() {\r\n        console.log(\"选择方向\")\r\n        this.dir = - this.dir;\r\n    }\r\n\r\n\r\n    //判断前方是墙\r\n    checkIsWall(dist = 100, dir = this.dir) {\r\n        let p1 = this.worldCenter();\r\n        let p2 = cc.v2(p1.x + dir * dist, p1.y)\r\n        let res = this._world.rayCast(p1, p2, cc.RayCastType.Closest)\r\n        let r = res[0];\r\n        if (r) {\r\n            let group = r.collider.node.group\r\n            if (group == 'wall' || group == 'pin') {\r\n                return true\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n\r\n    _dectedRole: Role;\r\n\r\n    raycast(dir?) {\r\n        dir = dir || this.dir\r\n        let p1 = this.worldCenter();\r\n        let p2 = cc.v2(p1.x + this.dir * 800, p1.y)\r\n        let res = this._world.rayCast(p1, p2, cc.RayCastType.Closest)\r\n        // console.log(res[0].collider.node.group);\r\n        for (let k in res) {\r\n            let r = res[k];\r\n            let role = r.collider.getComponent(Role);\r\n            if (role) {\r\n                this.fsm.changeState(State.Detected)\r\n                role.beDetected(this);\r\n                this._dectedRole = role;\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n\r\n    needHavaRest() {\r\n        let r = Math.random();\r\n        if (r < 0.5) {\r\n            this.fsm.changeState(State.Idle);\r\n            if (this.audio_seek) {\r\n                Device.playEffect(this.audio_seek);\r\n            }\r\n        }\r\n\r\n    }\r\n\r\n    onEnter_Idle() {\r\n        // console.log('休息一会')\r\n        this.speed = 0;\r\n        this.playAnim(\"idle\")\r\n    }\r\n\r\n    onUpdate_Idle() {\r\n        if (this.fsm.timeElapsed > 1.0) {\r\n            this.fsm.revertState();\r\n        }\r\n    }\r\n\r\n    go_frozen() {\r\n        this.fsm.changeState(State.Freezed);\r\n    }\r\n    exit_frozen() {\r\n        this.fsm.changeState(State.Judge);\r\n    }\r\n\r\n    onEnter_Freezed() {\r\n        this.skeleton.timeScale = 0;\r\n    }\r\n\r\n    onExit_Freezed() {\r\n        this.skeleton.timeScale = 1;\r\n    }\r\n\r\n    onUpdate_Seek() {\r\n        // p1 主角的眼\r\n        this.move();\r\n    }\r\n\r\n    onEnter_Detected(state) {\r\n        //显示 感叹号 \r\n        this.anim.play(\"inform\");\r\n        if (this.detected_audio)\r\n            Device.playEffect(this.detected_audio, false);\r\n    }\r\n\r\n    onUpdate_Detected() {\r\n        ///chase   \r\n        if (this.fsm.timeElapsed > 0.3) {\r\n            // 后开始 chase \r\n            this.fsm.changeState(State.Chase)\r\n        }\r\n    }\r\n\r\n    onExit_Detected(state) {\r\n        Device.stopSfx(state.sfx)\r\n    }\r\n\r\n    onEnter_Chase() {\r\n        this.playAnim(\"pursue\")\r\n        if (this.audio_walk)\r\n            Device.playEffect(this.audio_walk);\r\n        if (this._dectedRole)\r\n            this.dir = this._dectedRole.node.x < this.node.x ? -1 : 1;\r\n        this.speed = 2;\r\n        this.armature.animation.timeScale = 2;\r\n    }\r\n\r\n    onUpdate_Chase() {\r\n        this.move();\r\n        //3s 后恢复正常状态 \r\n        if (this.fsm.timeElapsed > 2.5) {\r\n            this.fsm.changeState(State.LoseTarget)\r\n        }\r\n    }\r\n\r\n    onEnter_LoseTarget() {\r\n        //显示问号 \r\n        console.log('目标丢失!')\r\n        this.anim.play(\"question\")\r\n        if (this.audio_question) {\r\n            Device.playEffect(this.audio_question)\r\n        }\r\n        evt.emit(\"Game.loseTarget\", this);\r\n    }\r\n    onUpdate_LoseTarget() {\r\n        if (this.fsm.timeElapsed > 0) {\r\n            this.fsm.changeState(State.Seek);\r\n        }\r\n    }\r\n\r\n    onExit_LoseTarget() {\r\n        this.dir *= -1\r\n        this.armature.animation.timeScale = 1;\r\n    }\r\n\r\n    onEnter_Catch(state, param) {\r\n        evt.emit(\"Game.catch\", param)\r\n        this.playAnim(\"idle\")\r\n        if (this.audio_catched) {\r\n            Device.playEffect(this.audio_catched, false);\r\n        }\r\n        if (this._catchedRole)\r\n            this.dir = this._catchedRole.node.x < this.node.x ? -1 : 1;\r\n        // state.setInterval(1.5, this.bite, this)  \r\n    }\r\n\r\n    bite() {\r\n        this.fadeIn('bite', 2)\r\n        if (this.audio_bite) {\r\n            Device.playEffect(this.audio_bite, false);\r\n        }\r\n    }\r\n\r\n    onUpdate_Catch(state) {\r\n    }\r\n\r\n    _catchedRole: Role = null;\r\n\r\n    onBeginContact(contact: cc.PhysicsContact, selfCollider, other: cc.PhysicsCollider) {\r\n        if (this.collider && this.collider.enabled == false) return;\r\n        if (this.fsm.isInState(State.Freezed)) return;\r\n        if (Game.instance.isOver) return;\r\n        let group = other.node.group;\r\n        if (group == 'role') {\r\n            if (this.isDead()) return\r\n            this._catchedRole = other.getComponent(Role);\r\n            this.fsm.changeState(State.Catch, 'role')\r\n            return;\r\n        } else if (group == 'target') {\r\n            if (this.isDead()) return\r\n            this.fsm.changeState(State.Catch, 'target')\r\n            return;\r\n        } else if (group == 'bomb') {\r\n            contact.disabled = true;\r\n            if (this.isDead()) {\r\n                return;\r\n            }\r\n            if (this.node.name == 'badman') {\r\n                let bomb = other.getComponent(Bomb);\r\n                this.getBomb(bomb);\r\n                return;\r\n            }\r\n        } else if (group == 'spike') {\r\n            Device.playSfx(\"arrow_hit_body\")\r\n            if (this.isDead()) return;\r\n            this.goDead();\r\n            return\r\n        }\r\n        let m = contact.getWorldManifold()\r\n        // console.log(m.normal.x)\r\n        if (m.normal.x >= 0.98) {\r\n            this.dir = -1;\r\n        } else if (m.normal.x <= -0.98) {\r\n            this.dir = 1\r\n        }\r\n    }\r\n\r\n    getBomb(bomb: Bomb) {\r\n        if (this.bomb || bomb.holder) return;\r\n        this.bomb = bomb;\r\n        bomb.holder = this.node;\r\n        bomb.hide();\r\n        this.handSlot.displayIndex = 0;\r\n        if (this.bombTooltip)\r\n            this.bombTooltip.bomb = bomb;\r\n\r\n\r\n    }\r\n\r\n    loseBomb() {\r\n        if (this.handSlot) this.handSlot.displayIndex = -1;\r\n        if (this.bombTooltip)\r\n            this.bombTooltip.bomb = null;\r\n        if (cc.isValid(this.bomb)) {\r\n            if (this.bomb.isExploded) return;\r\n            let pos = this.node.position\r\n            pos.y += 100;\r\n            this.bomb.drop(pos);\r\n            this.bomb.holder = null;\r\n            this.bomb = null;\r\n        }\r\n    }\r\n\r\n    move() {\r\n        // this.node.x += this.dir * this.speed;\r\n        // this.body.linearVelocity.x = this.dir * this.speed * 1000;\r\n        let v = this.body.linearVelocity;\r\n        this.body.linearVelocity = cc.v2(this.dir * this.speed * 150, v.y)\r\n    }\r\n\r\n    onEnter_Dead(state, dur) {\r\n    }\r\n\r\n    onUpdate_Dead(state) {\r\n\r\n    }\r\n\r\n\r\n    removeSelf() {\r\n        this.node.destroy();\r\n    }\r\n\r\n\r\n    goDead(dead_anim = 'dead') {\r\n        if (dead_anim != 'dead') {\r\n            if (!this.armature.animation.hasAnimation(dead_anim)) {\r\n                dead_anim = 'dead'\r\n            }\r\n        }\r\n        this.playAnim(dead_anim, 1)\r\n        if (this.audio_dead)\r\n            Device.playEffect(this.audio_dead);\r\n\r\n        if (this.dead_with_fall) {\r\n            this.fsm.changeState(State.Dead);\r\n            this.body.gravityScale = 10;\r\n            this.body.linearDamping = 0;\r\n            this.body.linearVelocity = cc.v2(0, 1000);\r\n            this.body.angularVelocity = 1500;\r\n            this.collider.enabled = false;\r\n        } else {\r\n            this.fsm.changeState(State.Dead);\r\n            this.scheduleOnce(this.removeSelf, 1.5)\r\n        }\r\n        this.loseBomb();\r\n        evt.emit(\"Game.enemyDead\", this)\r\n    }\r\n\r\n    isDead() {\r\n        return this.fsm.isInState(State.Dead)\r\n    }\r\n\r\n}\r\n"]}