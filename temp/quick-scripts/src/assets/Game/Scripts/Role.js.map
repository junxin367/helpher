{"version":3,"sources":["assets\\Game\\Scripts\\Role.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import AIEnemy from \"./AIEnemy\";\r\nimport FSM from \"../../framework/core/FSM\";\r\nimport { evt } from \"../../framework/core/event\";\r\nimport ItemBall from \"./ItemBall\";\r\nimport ItemKey from \"./ItemKey\";\r\nimport Door from \"./Door\";\r\nimport ccUtil from \"../../framework/utils/ccUtil\";\r\nimport SkeletonBase from \"./SkeletonBase\";\r\nimport KeyToggle, { KeyDir } from \"./KeyToggle\";\r\nimport Device from \"../../framework/misc/Device\";\r\nimport Target from \"./Target\";\r\nimport RemoveOutOfView from \"./RemoveOutOfView\";\r\nimport Thunder from \"./Levels/Thunder\";\r\nimport { UserInfo } from \"../../framework/extension/weak_net_game/UserInfo\";\r\nimport Ballon from \"./Ballon\";\r\nimport Bomb from \"./Bomb\";\r\nimport ItemPortal from \"./Portal\";\r\nimport { Toast } from \"../../framework/ui/ToastManager\";\r\nimport Unity from \"./Common/Unity\";\r\nimport Game from \"./Game\";\r\nimport Effect from \"./Levels/Effect\";\r\nconst { ccclass, property } = cc._decorator;\r\n\r\nenum State {\r\n    Breath,\r\n    Idle,\r\n    Move,\r\n    Shocked,\r\n    Cliff,\r\n    Flee,\r\n    Lose,\r\n    Win,\r\n    Dead,\r\n    PrepareGun,\r\n    Fly,\r\n    Trigger,\r\n    Kick\r\n}\r\n\r\nenum Emotion {\r\n    Normal,\r\n    Happy,\r\n    Frightened\r\n}\r\n\r\nconst Role_sounds = ['enheng', 'laugh']\r\nconst Dead_sounds = ['dead', 'dead2']\r\n\r\n\r\n@ccclass\r\nexport default class Role extends SkeletonBase {\r\n    fsm: FSM;\r\n    private _dir: number = 1;\r\n\r\n    speed: number = 1;\r\n\r\n    baseScale: number = 0;\r\n\r\n    emotionState: FSM;\r\n\r\n    isLose = false;\r\n\r\n    @property(cc.AudioClip)\r\n    audio_cry: cc.AudioClip = null;\r\n\r\n    @property(cc.AudioClip)\r\n    audio_laugh: cc.AudioClip = null;\r\n\r\n    static self: Role = null\r\n\r\n    hasGun: boolean = false;\r\n\r\n    colliders: cc.PhysicsCollider[];\r\n\r\n    inHandObject: dragonBones.Armature = null;\r\n\r\n    ballon: Ballon = null;\r\n\r\n    public get dir(): number {\r\n        return this._dir;\r\n    }\r\n    public set dir(value: number) {\r\n        this._dir = value;\r\n        this.node.scaleX = this.baseScale * value;\r\n    }\r\n\r\n    start() {\r\n        Role.self = this;\r\n        evt.on(\"Game.keyMoved\", this.checkMove, this);\r\n        evt.on('Game.hello', this.sayHelloBack, this);\r\n        evt.on(\"Game.loseTarget\", this.onLoseTarget, this)\r\n        evt.on(\"Game.catch\", this.beCatched, this)\r\n        evt.on(\"Game.bomb\", this.goDead, this);\r\n        evt.on(\"Game.changeRoleDir\", this.changeDirManually, this);\r\n        evt.on(\"Game.enemyDead\", this.onEnemyDead, this);\r\n        //this.beCatched(enemy)\r\n        this.colliders = this.getComponents(cc.PhysicsCollider);\r\n\r\n\r\n        this.baseScale = this.node.scale;\r\n\r\n        this.fsm = this.addComponent(FSM);\r\n        this.fsm.init(this, State);\r\n        this.fsm.enterState(State.Idle)\r\n\r\n        this.emotionState = this.addComponent(FSM);\r\n        this.emotionState.init(this, Emotion)\r\n        this.emotionState.enterState(Emotion.Normal)\r\n\r\n\r\n        let check = this.addComponent(RemoveOutOfView);\r\n        check.onOffScreen.on(this.onOutOfScreen, this)\r\n        this.equipGun();\r\n        Unity.loadSkins(this.skeleton, 1);\r\n    }\r\n\r\n    onOutOfScreen() {\r\n        evt.emit(\"Game.lose\")\r\n    }\r\n\r\n    changeDirManually() {\r\n        if (this.fsm.isInState(State.Idle)) {\r\n            this.checkMove();\r\n        } else {\r\n            //changeDir\r\n            if (this.fsm.isInState(State.Move))\r\n                this.dir *= -1;\r\n        }\r\n    }\r\n\r\n    onLoseTarget() {\r\n        //back to nomrmal\r\n        this.armature.animation.timeScale = 1;\r\n        // this.fsm.changeState(State.Breath);\r\n    }\r\n\r\n    onDestroy() {\r\n        evt.off(this);\r\n        Role.self = null;\r\n\r\n    }\r\n\r\n    /** 给主角装武器 ,后面给抵挡一次伤害*/\r\n\r\n    _thunderPrefab: cc.Prefab = null;\r\n\r\n    equipGun() {\r\n        this.hasGun = true;\r\n        ccUtil.getRes(\"Prefabs/effect/thunder\", cc.Prefab).then(v => {\r\n            this._thunderPrefab = v;\r\n        })\r\n    }\r\n\r\n    onBeginContact(contact: cc.PhysicsContact, self, other: cc.PhysicsCollider) {\r\n        let group = other.node.group;\r\n        if (group == 'enemy') {\r\n            let enemy = other.getComponent(AIEnemy)\r\n            if (enemy) {\r\n                contact.disabled = true;\r\n            }\r\n        } else if (group == 'target') {\r\n            //win \r\n            contact.disabled = true;\r\n            this.fsm.changeState(State.Win);\r\n        } else if (group == 'pin') {\r\n            // if (other.node.y > this.node.y + 30) {\r\n            //     contact.disabledOnce = true;\r\n            // }\r\n\r\n            if (this.fsm.isInState(State.Fly)) {\r\n                contact.disabled = true;\r\n            }\r\n            let pin = other.getComponent(KeyToggle);\r\n            if (pin) {\r\n                if (pin.curDir.y < 0) {\r\n                    let wpos = ccUtil.getWorldPosition(other.node)\r\n                    if (wpos.y >= this.worldCenter().y) {\r\n                        contact.disabled = true;\r\n                    }\r\n                } else if (pin.curDir.y > 0) {\r\n                    this.fsm.changeState(State.Idle);\r\n                }\r\n            }\r\n        } else if (group == 'item') {\r\n            //吃道具  ball, key \r\n            let name = other.node.name;\r\n            if (name == 'ball') {\r\n                let ball = other.node.getOrAddComponent(ItemBall);\r\n                ball.go();\r\n                Device.playSfx(\"pickup\")\r\n            } else if (name == 'key') {\r\n                let key = other.node.getOrAddComponent(ItemKey);\r\n                key.go();\r\n            } else if (name == 'xuehua') {\r\n                Effect.throw_snowballs();\r\n                other.node.destroy();\r\n            } else if (name == 'gun') {\r\n                UserInfo.gun_num += 1;\r\n                this.fsm.changeState(State.Idle);\r\n                this.fastFadeIn(\"gun_out\", 1)\r\n                this.scheduleOnce(this.open_fire, 0.5);\r\n                other.node.destroy();\r\n            } else if (name == 'magnet') {\r\n                Effect.do_magnet();\r\n                other.node.destroy();\r\n            }\r\n        } else if (group == 'wall') {\r\n            if (this.fsm.isInState(State.Fly)) {\r\n                contact.disabled = true;\r\n            }\r\n            Device.playSfx('fall')\r\n            // let name = other.node.name;\r\n            // if (name == 'door') {\r\n            //     let door = other.node.addComponent(Door)\r\n            // }\r\n        } else if (group == 'stop') {\r\n            this.fsm.changeState(State.Idle, 0.5);\r\n        } else if (group == 'ballon') {\r\n            //ballon\r\n\r\n            let ballon = other.getComponent(Ballon);\r\n            if (cc.isValid(ballon)) {\r\n                if (ballon.isDead()) return;\r\n                let handSlot = this.handSlot;\r\n                // handSlot.childArmature = ballon.armature;\r\n                // let hand = cc.find(\"ATTACHED_NODE_TREE/ATTACHED_NODE:youshou/ATTACHED_NODE:youshou1\", this.node)\r\n                // ballon.node.parent = hand;\r\n                if (this.inHandObject == null) {\r\n                    let factory = dragonBones.CCFactory.getInstance();\r\n                    handSlot.childArmature = factory.buildArmature(\"Armature\", ballon.skeleton.getArmatureKey())\r\n                    handSlot.childArmature.animation.play(\"up\", 0)\r\n                    this.inHandObject = handSlot.childArmature;\r\n                } else {\r\n                    handSlot.childArmature = this.inHandObject;\r\n                }\r\n                // factory.replaceSlotDisplay(ballon.skeleton.getArmatureKey(), \"Armature\", \"ballon\", \"ballon\", handSlot);\r\n                if (cc.isValid(this.ballon)) {\r\n                    try {\r\n                        let p = cc.v2(this.node.x + 25 * this.dir, this.node.y + 100);\r\n                        this.ballon.flyAway(p);\r\n                    } catch (e) {\r\n                        console.error(e)\r\n                    }\r\n                }\r\n                this.ballon = ballon;\r\n                this.fsm.changeState(State.Fly)\r\n                // this.scheduleOnce(() => , 0.3)\r\n                // this.fsm.changeState(State.Fly);\r\n                let state = this.fsm.getState(State.Fly) as any;\r\n                state.fly_startY = this.ballon.node.y;\r\n                ballon.node.active = false;\r\n                Device.playSfx(\"pickup\")\r\n                // ballon.node.destroy();\r\n            }\r\n        } else if (group == 'spike') {\r\n            Device.playSfx(\"arrow_hit_body\")\r\n            this.goDead();\r\n        } else if (group == 'bomb') {\r\n            let bomb = other.getComponent(Bomb);\r\n            if (bomb.isHiding) return;\r\n            this.fsm.changeState(State.Kick, bomb);\r\n        }\r\n    }\r\n\r\n    onEnter_Kick(state, bomb) {\r\n\r\n        this.playAnim(\"kick\", 1)\r\n        this.body.linearVelocity = cc.v2(0, 0)\r\n        this.skeleton.addEventListener(dragonBones.EventObject.COMPLETE, () => {\r\n\r\n        })\r\n        state.bomb = bomb\r\n    }\r\n\r\n    onUpdate_Kick() {\r\n        if (this.fsm.timeElapsed > 0.5) {\r\n            this.fsm.changeState(State.Idle)\r\n        }\r\n    }\r\n\r\n    onExit_Kick(state) {\r\n        Device.playSfx(\"kick_bomb\")\r\n        let bomb = state.bomb as Bomb;\r\n        bomb.goAway(this.dir);\r\n    }\r\n\r\n\r\n    //被抓住\r\n    beCatched() {\r\n        console.log(\"lose game!!!!\")\r\n        // cc.audioEngine.playEffect(this.audio_cry, false);\r\n        Device.playSfx(\"ough\");\r\n        this.fsm.changeState(State.Lose)\r\n    }\r\n\r\n    _dectedDir: number = 0;\r\n    _dectedEnemy: AIEnemy = null;\r\n    //被 发现s\r\n    beDetected(enemy: AIEnemy) {\r\n        console.log(\"be detected \")\r\n        //惊吓 s\r\n        evt.emit(\"Game.beDected\")\r\n        this._dectedDir = this.node.x > enemy.node.x ? 1 : -1;\r\n        this._dectedEnemy = enemy;\r\n        this.dir = -this._dectedDir;\r\n        // if (this.hasGun) {\r\n        //     this.fsm.changeState(State.PrepareGun)\r\n        // } else {\r\n        this.fsm.changeState(State.Shocked);\r\n        // }\r\n    }\r\n\r\n    onEnter_Shocked() {\r\n        if (!this.hasGun) {\r\n            cc.audioEngine.playEffect(this.audio_cry, false);\r\n        }\r\n        this.playAnim(\"shocked\", 1)\r\n    }\r\n\r\n\r\n\r\n    /**开火 */\r\n    open_fire() {\r\n        this.playAnim(\"idle\")\r\n        // this.fastFadeIn(\"gun_out\", 1)\r\n        this.fsm.changeState(State.Trigger);\r\n    }\r\n\r\n    onEnter_Trigger() {\r\n        let enemies = this.checkEnemy()\r\n        if (enemies.length == 0) {\r\n            enemies = this.checkEnemy(null, -this.dir)\r\n            if (enemies.length > 0) {\r\n                this.dir = -this.dir\r\n            }\r\n        }\r\n        if (enemies.length == 0) {\r\n            Toast.make(\"前方没有敌人，无法使用！\")\r\n            return;\r\n        }\r\n        this.stopAnim();\r\n        this.playAnim(\"gun\", 1)\r\n\r\n        this.lightEnemies(enemies);\r\n\r\n        evt.emit(\"Game.UseGun\");\r\n        UserInfo.gun_num -= 1;\r\n    }\r\n\r\n    async lightEnemies(enemies) {\r\n        let first = this.node;\r\n        for (var i = 0; i < enemies.length; i++) {\r\n            let enemy = enemies[i]\r\n            enemy.goDead(\"dead_smoke\");\r\n            await this.getThunder().play(first, enemy.node, cc.v3(0, 60, 0));\r\n            first = enemy.node;\r\n        }\r\n    }\r\n\r\n\r\n    onUpdate_Trigger() {\r\n        if (this.fsm.timeElapsed > 1.5) {\r\n            this.fsm.changeState(State.Idle);\r\n        }\r\n    }\r\n\r\n    _thunder: Thunder = null;\r\n\r\n    getThunder() {\r\n        if (this._thunder == null) {\r\n            let node = cc.instantiate(this._thunderPrefab)\r\n            // this.node.addChild(node);\r\n            node.parent = this.node.parent;\r\n            this._thunder = node.getComponent(Thunder);\r\n        }\r\n        return this._thunder;\r\n    }\r\n\r\n\r\n\r\n    onUpdate_Shocked() {\r\n        if (this.fsm.timeElapsed > 0.5) {\r\n            //run\r\n            if (!this.isLose) {\r\n                this.fsm.changeState(State.Flee);\r\n            }\r\n        }\r\n    }\r\n\r\n\r\n    onEnter_Flee() {\r\n        this.dir = this._dectedDir\r\n        this.playAnim(\"walk\")\r\n        this.armature.animation.timeScale = 2;\r\n        this.changeEmotionState(Emotion.Frightened);\r\n    }\r\n\r\n    onUpdate_Flee() {\r\n        //walk away \r\n        let b = this.checkIsCliff(0);\r\n        if (b) {\r\n            this.fsm.changeState(State.Cliff);\r\n        }\r\n        if (this.fsm.timeElapsed > 2.5) {\r\n            this.fsm.changeState(State.Breath)\r\n        }\r\n        this.move();\r\n    }\r\n\r\n    onExit_Flee() {\r\n        this.armature.animation.timeScale = 1;\r\n    }\r\n\r\n    onEnter_Move() {\r\n        this.playAnim(\"walk\")\r\n        this.fadeIn(\"normal\", 1)\r\n    }\r\n\r\n    onUpdate_Move() {\r\n        this.move()\r\n        let b = this.checkIsCliff(0)\r\n        if (b) {\r\n            // this.fsm.changeState(State.Cliff)\r\n            this.fsm.changeState(State.Idle)\r\n            // this.dir *= -1;\r\n        } else if (this.checkIsWall()) {\r\n            this.fsm.changeState(State.Idle)\r\n            //change dir\r\n            this.dir *= -1;\r\n        }\r\n    }\r\n    onExit_Move() {\r\n        this.stopAnim();\r\n    }\r\n\r\n    onEnter_Breath(state) {\r\n        this.playAnim(\"breath\")\r\n        Device.playSfx(\"breath\")\r\n        state.setTimeout(1.0, () => this.fsm.changeState(State.Idle))\r\n    }\r\n\r\n    onEnter_Cliff() {\r\n        // this.playAnim('cliff', 1)\r\n        // Device.playSfx(\"cliff\")\r\n    }\r\n\r\n    onUpdate_Cliff() {\r\n        if (this.fsm.timeElapsed > 1) {\r\n            this.fsm.changeState(State.Idle)\r\n            // this.dir *= -1\r\n        }\r\n    }\r\n\r\n    onEnter_Idle(state, timeout) {\r\n        this.playAnim(\"idle\")\r\n        state.timeout = timeout;\r\n        state.setInterval(0.75, this.checkTarget, this);\r\n    }\r\n\r\n    onExit_Idle() {\r\n        this.stopAnim();\r\n    }\r\n\r\n    onUpdate_Idle(state) {\r\n        if (state.timeout) {\r\n            if (this.fsm.timeElapsed > state.timeout) {\r\n                this.fsm.revertState();\r\n            }\r\n        }\r\n    }\r\n\r\n    onEnter_Fly(state) {\r\n        // this.colliders.forEach(v => v.enabled = false)\r\n        if (this.fsm.getPreviousState().id != State.Fly) {\r\n            this.playAnim(\"fly_idle\")\r\n            this.fastFadeIn(\"fly_enter\", 1)\r\n        }\r\n\r\n        state.gravityScale = this.body.gravityScale;\r\n        this.body.gravityScale = 0;\r\n        state.fly_startY = this.ballon.node.y;\r\n    }\r\n\r\n    onUpdate_Fly(state) {\r\n        if (this.fsm.timeElapsed < 0.5) {\r\n            this.body.linearVelocity = cc.v2(this.dir * 75, 100);\r\n        } else {\r\n            this.body.linearVelocity = cc.v2(0, 100);\r\n        }\r\n        let dist = this.node.y - state.fly_startY;\r\n        if (dist > 222) {\r\n            this.fsm.changeState(State.Idle);\r\n        }\r\n    }\r\n\r\n\r\n    onExit_Fly(state) {\r\n        //recovery \r\n        // this.colliders.forEach(v => v.enabled = true)\r\n        this.body.gravityScale = state.gravityScale\r\n        this.handSlot.childArmature = null;\r\n\r\n        let p = cc.v2(this.node.x + 25 * this.dir, this.node.y + 100);\r\n        this.ballon.flyAway(p);\r\n    }\r\n\r\n    checkTarget() {\r\n        this.raycast();\r\n    }\r\n\r\n    /**判断 前方是否是老头 */\r\n    raycast() {\r\n        let cliff = this.checkIsCliff(0)\r\n        if (cliff) {\r\n            return false;\r\n        }\r\n        let p1 = this.worldCenter();\r\n        let p2 = cc.v2(p1.x + this.dir * 800, p1.y)\r\n        let res = this._world.rayCast(p1, p2, cc.RayCastType.Closest)\r\n        // console.log(res[0].collider.node.group);\r\n        let r = res[0]\r\n        if (r) {\r\n            let group = r.collider.node.group;\r\n            if (group == 'target') {\r\n                this.fsm.changeState(State.Move)\r\n                evt.emit(\"Game.seeTarget\", this);\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n\r\n    onEnter_Lose() {\r\n        //游戏失败\r\n        this.isLose = true;\r\n        // this.playAnim(\"idle\")\r\n        this.changeEmotionState(Emotion.Frightened)\r\n    }\r\n\r\n    onEnter_Win() {\r\n        //游戏胜利\r\n        this.playAnim2('idle', \"happy\")\r\n        evt.emit(\"Game.win\")\r\n    }\r\n\r\n    move() {\r\n        // this.node.x += this.dir * this.speed;\r\n        let v = this.body.linearVelocity;\r\n        this.body.linearVelocity = cc.v2(this.dir * this.speed * 180, v.y)\r\n    }\r\n\r\n\r\n    playEmmmCD: number = 0;\r\n\r\n    playEmmm() {\r\n        if (this.playEmmmCD <= 0) {\r\n            Device.playSfx(\"eh\")\r\n            this.playEmmmCD = 5;\r\n        }\r\n    }\r\n\r\n    //判断能否 移动\r\n    checkMove() {\r\n        if (this.fsm.isInState(State.Shocked) ||\r\n            this.fsm.isInState(State.PrepareGun) ||\r\n            this.fsm.isInState(State.Flee) ||\r\n            this.fsm.isInState(State.Trigger) ||\r\n            this.fsm.isInState(State.Fly) ||\r\n            this.fsm.isInState(State.Dead)) return;\r\n        if (this.isLose) return;\r\n\r\n        let wall = this.checkIsWall(60, this.dir);\r\n        if (wall) {\r\n            //不处理\r\n            let wall2 = this.checkIsWall(60, -this.dir);\r\n            if (!wall2) {\r\n                this.dir *= -1;\r\n                this.changeToMove()\r\n            } else {\r\n                this.playEmmm()\r\n            }\r\n        } else {\r\n            let cliff = this.checkIsCliff(0)\r\n            if (!cliff) {\r\n                //canmove \r\n                this.changeToMove()\r\n            } else {\r\n                // this.fadeIn(\"cliff\", 1)\r\n                let cliff = this.checkIsCliff(0, -this.dir)\r\n                if (!cliff) {\r\n                    this.dir *= -1;\r\n                    this.changeToMove();\r\n                }\r\n            }\r\n        }\r\n        this.playEmmmCD -= 1;\r\n    }\r\n\r\n    changeToMove() {\r\n        if (!this.isLose) {\r\n            if (Math.random() < 0.5) {\r\n                Device.playSfx(g.getRandomInArray(Role_sounds))\r\n            }\r\n            this.fsm.changeState(State.Move);\r\n        }\r\n    }\r\n\r\n    //判断前方是墙\r\n    checkIsWall(dist = 60, dir = this.dir) {\r\n        // let p1 = this.node.getBoundingBoxToWorld().center;\r\n        let p1 = this.worldCenter();\r\n        let p2 = cc.v2(p1.x + dir * dist, p1.y)\r\n        let res = this._world.rayCast(p1, p2, cc.RayCastType.Closest)\r\n        let r = res[0];\r\n        if (r) {\r\n            let group = r.collider.node.group\r\n            if (group == 'wall' || group == 'pin' || group == 'obstacle' || group == 'weapon') {\r\n                return true\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n\r\n    //判断前方是悬崖\r\n    //height从100 的高处观察是否有悬崖\r\n    checkIsCliff(height, dir = this.dir) {\r\n        height = height || 100;\r\n        //100:为高度，安全区域 射线 最大长度为c\r\n        let c = height / Math.sin(cc.misc.degreesToRadians(45))\r\n        // let csq = c * c;\r\n        // c += 5;//5个像素误差\r\n        let rect = this.node.getBoundingBoxToWorld();\r\n        let p1 = cc.v2(rect.center.x, rect.origin.y + height);\r\n        let p2 = cc.v2(p1.x + dir * c, p1.y - c)\r\n        let res = this._world.rayCast(p1, p2, cc.RayCastType.Closest)\r\n        let r = res[0];\r\n        return r == null;\r\n        // if (r) {\r\n        //     let lensq = cc.Vec2.squaredDistance(p1, r.point);\r\n        //     if (lensq > csq) {\r\n        //         //看到悬崖\r\n        //         return true\r\n        //     }\r\n        // }\r\n        return false;\r\n    }\r\n\r\n    tmp_enemies = []\r\n\r\n    /**看前方是否有敌人 */\r\n    checkEnemy(height = null, dir = this.dir): AIEnemy[] {\r\n        height = height || 90;\r\n        let rect = this.node.getBoundingBoxToWorld();\r\n        let p1 = cc.v2(rect.center.x, rect.origin.y + height);\r\n        let p2 = cc.v2(p1.x + dir * 800, p1.y)\r\n        let res = this._world.rayCast(p1, p2, cc.RayCastType.All)\r\n        this.tmp_enemies.splice(0);\r\n        for (let i = 0; i < res.length; i++) {\r\n            let r = res[i]\r\n            if (r && r.collider) {\r\n                let enemy = r.collider.getComponent(AIEnemy);\r\n                if (enemy) this.tmp_enemies.push(enemy);\r\n            }\r\n        }\r\n        return this.tmp_enemies;\r\n    }\r\n\r\n    onEnemyDead() {\r\n        // this.emotionState.changeState(Emotion.Happy);\r\n        this.scheduleOnce(v => {\r\n            this.changeEmotionState(Emotion.Happy);\r\n        }, 1)\r\n        Device.playEffect(this.audio_laugh);\r\n    }\r\n\r\n\r\n    onEnter_Happy(state, param) {\r\n        if (this.isDead()) return\r\n        if (param) {\r\n            this.fadeIn(param, 1)\r\n        } else {\r\n            this.fadeIn(\"happy\", 1)\r\n        }\r\n    }\r\n\r\n    onEnter_Normal() {\r\n        if (this.isDead()) return\r\n        this.fadeIn(\"normal\", 1)\r\n    }\r\n\r\n    onEnter_Frightened() {\r\n        if (this.isDead()) return\r\n        this.fadeIn(\"frightened\", 1)\r\n    }\r\n\r\n    onUpdate_Frightened() {\r\n        if (this.emotionState.timeElapsed > 3.0) {\r\n            this.changeEmotionState(Emotion.Normal)\r\n        }\r\n    }\r\n\r\n    onUpdate_Happy() {\r\n        if (this.emotionState.timeElapsed > 3.0) {\r\n            this.changeEmotionState(Emotion.Normal)\r\n        }\r\n    }\r\n\r\n    changeEmotionState(state, param?) {\r\n        if (this.isDead()) return;\r\n        this.emotionState.changeState(state, param);\r\n    }\r\n\r\n    sayHelloBack(target: Target) {\r\n        if (this.fsm.isInState(State.Idle)) {\r\n            let targetDir = target.dir;\r\n            this.dir = -targetDir;\r\n            this.changeEmotionState(Emotion.Happy, 'hello')\r\n            Device.playSfx(\"hi\")\r\n        } else {\r\n            this.changeEmotionState(Emotion.Happy)\r\n        }\r\n    }\r\n\r\n    goDead() {\r\n        this.fsm.changeState(State.Dead);\r\n\r\n    }\r\n\r\n    onUpdate_Dead() {\r\n\r\n    }\r\n\r\n    onEnter_Dead(state) {\r\n        Device.playSfx(g.getRandomInArray(Dead_sounds))\r\n        this.playAnim(\"dead\", 1)\r\n        state.setTimeout(0.5, () => {\r\n            evt.emit(\"Game.lose\")\r\n            this.fadeIn(\"eye_close\", 1)\r\n        })\r\n    }\r\n\r\n    isDead() {\r\n        return this.fsm.isInState(State.Dead);\r\n    }\r\n\r\n}"]}