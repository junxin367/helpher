{"version":3,"sources":["assets\\framework\\extension\\ttsdk\\ttsdk.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import { evt } from \"../../core/event\";\nimport { TTGameConfig } from \"./TTGameConfigs\";\nimport { UserInfo } from \"../weak_net_game/UserInfo\";\nimport DouyinStorage from \"./DouyinStorage\";\n\n\nclass Global {\n    static videoAd = undefined\n    static bannerAd = undefined\n    static interstitialAd = undefined\n    static isBannerShow = false;\n    static videoAdLoadCount = 0 //视频广告加载次数\n    static bannerAdLoadCount = 0 //banner广告加载次数\n    static video_close_callback: (ret: any) => void;\n    static video_error_callback: () => void;\n    static video_load_callback: () => void;\n\n}\n\n\nexport interface ShareInfo {\n    title: string,\n    imageUrl: string,\n    query?: string,\n    ald_desc?: string\n\n    id?: string,\n    queryObjects: Object\n}\n\nclass TTSdk {\n    _userInfo: any = null;\n    _loginCode: any;\n    _openId: string = \"\";\n\n    _db: any;\n    _version: number;\n    _systemInfo: any;\n\n    public get Ver(): number { return this._version; }\n\n    public get userInfo() { return this._userInfo }\n\n    public get parent() {\n        if (!window.tt) return \"\"\n        let info = tt.getLaunchOptionsSync();\n        if (info.scene == 1007 || info.scene == 1008) {//通过分享进入游戏\n            let openId = info.query[\"user_id\"];\n            return openId\n        }\n        return \"\"; //默认\n    }\n\n    public set openId(v) {\n        this._openId = v\n    }\n\n    public get openId() {\n        return this._openId\n    }\n\n\n    constructor() {\n        if (window.tt) {\n            if (this._version == null) {\n                this._systemInfo = tt.getSystemInfoSync();\n                let ver = this._systemInfo.SDKVersion.replace(/\\./g, \"\")\n                this._version = parseInt(ver);\n            }\n        }\n    }\n\n    requestDB(tbname, callback, target) {\n        this._db.collection(tbname).get({\n            success: function (res) {\n                console.log(\"get \" + tbname + \" succ:\", res.data)\n                // self._shareConfig = res.data;\n                if (callback) callback.call(target, res.data);\n            }, fail: (res) => {\n                console.log(\"get \" + tbname + \" fail:\")\n                if (callback) callback.call(target)\n            }\n        });\n    }\n\n\n    requestConfig(callback) {\n        this._db.collection(\"t_conf\").get({\n            success: function (res) {\n                console.log(\"get configs succ:\", res.data)\n                // self._shareConfig = res.data;\n                if (callback) callback(res.data);\n            }, fail: (res) => {\n                console.log(\"get configs fail:\", res)\n                if (callback) callback(null)\n            }\n        });\n    }\n\n\n    /**\n     * 打开分享\n     * @param share_cfg {ShareInfo}\n     */\n    async openShare(share_cfg: ShareInfo, params?) {\n        if (!g.iswxgame()) return;\n        let info = {} as ShareInfo\n        info.title = share_cfg.title;\n        info.imageUrl = share_cfg.imageUrl;\n        let querys: any = info.queryObjects || {};\n        if (info != null) {\n            let querystr = \"\"\n            params = params || {}\n            Object.keys(params).forEach(k1 => {\n                querys[k1] = params[k1]\n            })\n            querystr = Object.keys(querys).reduce((sum, k) => {\n                let v = querys[k]\n                return sum + `${k}=${v}&`\n            }, querystr)\n            info.query = querystr + \"time=\" + new Date().getTime()\n            info.ald_desc = share_cfg.ald_desc\n            console.log(\"open Share\", info)\n            tt.aldShareAppMessage(info);\n        }\n    }\n\n    private createButton(callback, x?, y?, width?, height?) {\n        console.log(\"-------------createButton\");\n        let button = tt.createUserInfoButton({\n            type: \"text\",\n            text: \"     \",\n            style: {\n                x: x || 0, y: y || 0,\n                width: width || cc.winSize.width,\n                height: height || cc.winSize.height,\n                lineHeight: 40,\n                backgroundColor: '#00000000',\n                color: '#ffffff'\n            }\n        });\n        button.onTap(function (res) {\n            button.destroy();\n            if (res && res) {\n                if (callback) callback(res);\n            } else if (callback) callback(null);\n        });\n    }\n\n\n    private getUserInfo(callback) {\n        console.warn(\"-------------getUserInfo\");\n        tt.getUserInfo({\n            withCredentials: true,\n            lang: \"zh_CN\",\n            success: (res) => {\n                console.log(\"getUserInfo success.\", res);\n                if (callback) callback(res);\n            }, fail: (res) => {\n                console.log(\"getUserInfo:\", res);\n                if (callback) callback(null);\n            },\n            complete: null\n        });\n    }\n\n    oldAuthUser(callback) {\n        tt.authorize({\n            scope: \"scope.userInfo\",\n            success: (res) => {\n                console.log(res);\n                if (callback) callback(true);\n            }, fail: (res) => {\n                console.log(res);\n                if (callback) callback(false);\n            }, complete: null\n        });\n    }\n\n\n    public showShareMenu(cf: ShareInfo) {\n        let self = this;\n        tt.showShareMenu({\n            withShareTicket: true,\n            success: (res) => {\n                console.log(res);\n            }, fail: (res) => {\n                console.log(res);\n            }, complete: null\n        });\n        tt.aldOnShareAppMessage(function () {\n            // let content =  {title:TTGameConfig.default_share_title,imageUrl:cc.url.raw(TTGameConfig.deafult_share_imgUrl)}\n            return cf;\n        });\n    }\n\n    public start_recorder() {\n        if (window.tt) {\n            const recorder = tt.getGameRecorderManager();\n            recorder.onStart(res => {\n                console.log('开始录屏。。。');\n                // do somethine;  \n                UserInfo.start_time = Date.now() / 1000;\n                UserInfo.record_time = 0；\n            })\n\n            recorder.start({\n                duration: 20,\n            })\n\n            recorder.onPause(() => {\n                UserInfo.record_time = Date.now() / 1000 - UserInfo.start_time;\n                console.log('暂停录屏。。。');\n            });\n            recorder.onResume(() => {\n                UserInfo.start_time = Date.now() / 1000;\n                console.log('恢复录屏。。。');\n            });\n\n            recorder.onStop(res => {\n                console.log(res.videoPath);\n                UserInfo.record_path = res.videoPath;\n                UserInfo.record_time = Date.now() / 1000 - UserInfo.start_time + UserInfo.record_time;\n                console.log('结束录屏时长:' + UserInfo.record_time)\n            });\n\n            recorder.onError(res => {\n                console.log(\"录屏报错=\", res)\n            })\n        }\n\n    }\n\n\n    public stop_recorder() {\n        if (window.tt) {\n            const recorder = tt.getGameRecorderManager();\n            recorder.stop();\n        }\n    }\n\n    async checkSidebarOk(): Promise<boolean> {\n        return new Promise((resolve, reject) => {\n            tt.checkScene({\n                scene: \"sidebar\", success: () => {\n                    resolve(true);\n                },\n                fail: () => {\n                    resolve(false);\n                }\n            });\n        })\n    }\n\n\n    async douyin_sidebar_check() {\n        let isAvailable = await this.checkSidebarOk()\n        DouyinStorage.sidebarAvailable = isAvailable\n        tt.onShow(op => {\n            if (op.scene == \"021036\" && op.launch_from == \"homepage\" && op.location == \"sidebar_card\") {\n                //侧边 栏启动\n                //show icon \n                DouyinStorage.isFromSidebar = true;\n                DouyinStorage.sidebarAvailable = isAvailable;\n                // vm.show(\"Prefab/UI/BD_Guide_Sidebar\", \"sidebar\")\n            } else {\n                DouyinStorage.isFromSidebar = false;\n            }\n        });\n    }\n\n\n    // public ShareRecord(){\n    //     tt.shareAppMessage({    \n    //         channel: \"video\",\n    //         query: \"\",\n    //         templateId: \"1fidnqkeari9dnd18o\", // 替换成通过审核的分享ID\n    //         title: \"一路打怪冒险不要太爽\",\n    //         desc: \"在这里爱上冒险\",\n    //         extra: {\n    //           videoPath: UserInfo.record_path, // 可用录屏得到的本地文件路径\n    //           videoTopics: [\"披萨小王子2\"],\n    //         },\n    //         success() {\n\n    //         },\n    //         fail(e) {\n    //           console.log(\"分享视频失败\");\n    //           Toast.make(\"成功分享才能获得奖励哦\");\n    //         },\n    //       });\n    // }\n\n\n    private wxLogin(callback) {\n        tt.login({\n            success: (res) => {\n                console.log(\"code \", res.code);\n                this._loginCode = res.code;\n                evt.emit(\"wxlogin\", res.code);\n                if (callback) callback(true);\n            }, fail: (res) => {\n                if (callback) callback(false);\n            }, complete: null\n        });\n    }\n\n    public startAuth() {\n        let self = this;\n        return new Promise((resolve, reject) => {\n            if (self._version >= 220) {\n                self.createButton((ret) => {\n                    self.loginToServer(ret);\n                    if (ret)\n                        resolve(this._userInfo)\n                    else\n                        reject();\n                });\n            } else {\n                self.oldAuthUser((isAuth) => {\n                    if (isAuth) {\n                        self.getUserInfo((ret) => {\n                            self.loginToServer(ret);\n                            resolve(this._userInfo)\n                        });\n                    } else {\n                        reject();\n                    }\n                })\n            }\n        })\n    }\n\n    public checkAuth() {\n        if (ttsdk.userInfo) {\n            return Promise.resolve(ttsdk.userInfo);\n        } else {\n            return new Promise((resolve, reject) => {\n                tt.getSetting({\n                    success: (res) => {\n                        let auth = res.authSetting;\n                        if (auth[\"scope.userInfo\"]) {\n                            this.getUserInfo((ret) => {\n                                this.loginToServer(ret);\n                                resolve(this._userInfo)\n                            })\n                        } else {\n                            // return this.startAuth();\n                            resolve(null);\n                        }\n                    }, fail: null,\n                    complete: null,\n                });\n            })\n        }\n\n    }\n\n\n    private loginToServer(ret) {\n        console.log(\"loginToServer\", ret)\n        if (ret && ret.userInfo) {\n            this._userInfo = ret.userInfo\n        }\n        evt.emit(\"wxUserInfo\", this._userInfo, this._loginCode);\n    }\n\n    public login(p) {\n        if (!window.tt) return\n        let self = this;\n        //tt.cloud.init({traceUser: true});\n        // this._db = tt.cloud.database({env: \"release-2c87c4\"});//测试环境\n        //this._db = tt.cloud.database();\n        self.wxLogin(isLogin => {\n            if (!isLogin) return;\n            if (p) {\n                this.startAuth();\n            }\n        })\n    }\n\n    //发送消息到子域\n    public postMessage(cmd, data?) {\n        if (window.tt) {\n            let req = { cmd }\n            if (data) {\n                Object.keys(data).forEach(k => {\n                    req[k] = data[k]\n                })\n            }\n            tt.getOpenDataContext().postMessage(req);\n        }\n    }\n\n    public uploadScores(kvs) {\n        return new Promise((resolve, reject) => {\n            let obj = {\n                KVDataList: kvs,\n                success: function (d) {\n                    resolve(d)\n                },\n                fail: function () {\n                    reject();\n                },\n                complete: function () { },\n            }\n            console.warn(\"-------uploadScores\", kvs);\n            tt.setUserCloudStorage(obj)\n        })\n    }\n\n    public uploadScore(k, v, callback?) {\n        var kvDataList = new Array();\n        kvDataList.push({\n            key: k,\n            value: v\n        });\n\n        let obj = {\n            KVDataList: kvDataList,\n            success: function (d) {\n                if (callback) callback(d)\n            },\n            fail: function () { },\n            complete: function () { },\n        }\n        tt.setUserCloudStorage(obj)\n        // \"wxgame\": {\n        //     \"score\": 16,\n        //     \"update_time\": 1513080573\n        // },\n        // \"cost_ms\": 36500\n    }\n\n    public loadBannerAd(callback?) {\n        if (Global.bannerAd) {\n            Global.bannerAd.destroy()\n        }\n        if (!this._systemInfo)\n            this._systemInfo = tt.getSystemInfoSync();\n        var w = this._systemInfo.screenWidth / 2;\n        var h = this._systemInfo.screenHeight;\n\n        let isPor = this._systemInfo.screenWidth <= this._systemInfo.screenHeight;\n        let fixWidth = isPor ? this._systemInfo.screenWidth : (this._systemInfo.screenHeight / 3);\n        let modelStr = this._systemInfo.model\n        let isIOS = false;\n        if (modelStr) {\n            if (modelStr.indexOf(\"iPhone\") != -1) {\n                isIOS = true;\n            }\n        }\n        let bannerAd = tt.createBannerAd({\n            adUnitId: TTGameConfig.banner_ad_id,\n            style: {\n                left: 0,\n                top: 0,//cc.visibleRect.height\n                width: fixWidth\n            }\n        })\n        Global.bannerAd = bannerAd;\n        bannerAd.onResize(res => {\n            // if (fixWidth != res.width){\n            //     bannerAd.style.left = (w - res.width )/ 2 ;\n            //     bannerAd.style.top = h - (res.width / 16 * 9)-10;\n            // }\n\n            bannerAd.style.left = w - res.width / 2;\n            bannerAd.style.top = h - res.height - 10;\n        });\n        bannerAd.onLoad(() => {\n            Global.bannerAdLoadCount = 0;\n            if (callback) callback(\"load\", bannerAd);\n        });\n\n\n        // bannerAd.onLoad(() => {\n        //     Global.bannerAdLoadCount = 0;\n        //     bannerAd.style.left = w - bannerAd.style.realWidth / 2;\n        //     if (isIOS) {\n        //         bannerAd.style.top = h - bannerAd.style.realHeight -13;\n        //     } else {\n        //         bannerAd.style.top = h - bannerAd.style.realHeight;\n        //     }\n        //     if (callback) callback(\"load\", bannerAd)\n        // })\n        bannerAd.onError((err) => {\n            //加载失败\n            console.log(\n                \"ttsdk bannerAd onError code:\" + err.errCode + \" 当前次数\" + Global.bannerAdLoadCount\n            );\n            // console.log(\"ttsdk bannerAd onError code:\" + err.code + \" msg:\" + err.msg);\n            Global.bannerAdLoadCount += 1;\n            if (Global.bannerAdLoadCount < 4) {\n                this.loadBannerAd(callback);\n            }\n            Global.bannerAd = null;\n            if (callback) callback(\"error\")\n        });\n    }\n\n    public showBannerAd(errorCallback?): any {\n        console.log(\"ttsdk 显示banner广告\", Global.bannerAd)\n        if (Global.bannerAd) {\n            Global.bannerAd.show();\n            Global.isBannerShow = true\n            evt.emit(\"ttsdk.BannerReady\")\n        } else {\n            console.log(\"ttsdk 不存在banner资源....\");\n            this.loadBannerAd((v, ad) => {\n                if (v == \"load\") {\n                    this.showBannerAd()\n                } else if (v == 'error') {\n                    errorCallback && errorCallback();\n                }\n            });\n        }\n    }\n\n    isBannerShow() {\n        return Global.isBannerShow;\n    }\n\n    hideBannerAd() {\n        if (Global.bannerAd) {\n            Global.bannerAd.hide();\n            Global.isBannerShow = false;\n            // Global.bannerAd = null;\n        }\n    }\n\n    destroy() {\n        if (Global.bannerAd) {\n            Global.bannerAd.destroy();\n            Global.isBannerShow = false;\n            Global.bannerAd = null;\n        }\n    }\n\n    //interstitial\n    showInterstitial(errorCallback) {\n        // 创建插屏广告实例，提前初始化\n        const isToutiaio = tt.getSystemInfoSync().appName === \"Toutiao\";\n        // 插屏广告仅今日头条安卓客户端支持\n        if (isToutiaio) {\n            if (Global.interstitialAd) {\n                Global.interstitialAd.destroy();\n                Global.interstitialAd = null;\n            }\n            Global.interstitialAd = tt.createInterstitialAd({\n                adUnitId: TTGameConfig.interstitial_ad_id\n            });\n            if (Global.interstitialAd) {\n                Global.interstitialAd.load().then(() => {\n                    Global.interstitialAd.show();\n                }).catch(err => {\n                    console.log(err);\n                });\n                return new Promise(v => {\n                    Global.interstitialAd.onClose((res) => {\n                        v();\n                    })\n                })\n            }\n            return Promise.resolve();\n        }\n    }\n\n    loadVideoAd(callback) {\n        console.log(\"============ttsdk.loadVideoAD\");\n        // if (!Global.videoAd ) { //如果没有广告资源就加载新的视频广告\n        let self = this;\n        let videoAd = Global.videoAd;\n        if (!videoAd) {\n            videoAd = tt.createRewardedVideoAd({\n                adUnitId: TTGameConfig.video_ad_id\n            })\n        } else {\n            videoAd.offClose(Global.video_close_callback);\n            videoAd.offError(Global.video_error_callback);\n            videoAd.offLoad(Global.video_load_callback);\n        }\n        Global.video_error_callback = function () {\n            //加载失败\n            Global.videoAdLoadCount += 1;\n            //尝试4次\n            if (Global.videoAdLoadCount < 4) {\n                self.loadVideoAd(callback);\n            } else {\n                if (callback) callback(\"error\")\n            }\n        }\n\n        Global.video_close_callback = function (ret) {\n            //播放结束\n            console.log(\"ttsdk onClose...\");\n            Global.videoAdLoadCount = 0\n            if (callback) callback(\"close\", ret.isEnded)\n            Global.videoAd = null;\n        }\n\n        Global.video_load_callback = function () {\n            //加载成功\n            console.log(\"ttsdk onLoad\");\n            Global.videoAd = videoAd;\n            Global.videoAdLoadCount = 0;\n            // this.showBannerAd();\n            if (callback) callback(\"load\", videoAd)\n        }\n        // 用户触发广告后，显示激励视频广告\n        videoAd.show().catch(() => {\n            // this.hideBannerAd();\n            videoAd.load().then(() => {\n                videoAd.show();\n                if (callback) callback(\"show\")\n            }).catch(err => {\n                Global.videoAdLoadCount += 1;\n            });\n        })\n        videoAd.onError(Global.video_error_callback);\n        videoAd.onClose(Global.video_close_callback);\n        videoAd.onLoad(Global.video_load_callback);\n        Global.videoAd = videoAd\n    }\n\n    //录屏功能\n\n}\n\nexport let ttsdk: TTSdk = new TTSdk();"]}