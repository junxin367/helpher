{"version":3,"sources":["assets\\framework\\extension\\movement\\SFollowCamera.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;AAAA,wDAA4D;AAEtD,IAAA,KAAuC,EAAE,CAAC,UAAU,EAAnD,OAAO,aAAA,EAAE,QAAQ,cAAA,EAAC,gBAAgB,sBAAiB,CAAC;AAI3D;IAA0C,gCAAY;IAAtD;QAAA,qEA0DC;QAtDG,YAAM,GAAW,IAAI,CAAC;QAEtB,YAAM,GAAY,EAAE,CAAC,IAAI,CAAC,IAAI,CAAC;QAoB/B,cAAQ,GAAW,EAAE,CAAC,IAAI,CAAC,IAAI,CAAC;;QA+BhC,iBAAiB;IACrB,CAAC;IAlDG,6BAAM,GAAN;QAEI,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,YAAY,CAAC,EAAE,CAAC,MAAM,CAAC,CAAC;IAC/C,CAAC;IAED,4BAAK,GAAL;IACA,CAAC;IAED,4BAAK,GAAL;QAEI,IAAI,CAAC,IAAI,CAAC,CAAC,GAAG,CAAC,CAAC;QAChB,IAAI,CAAC,MAAM,GAAG,EAAE,CAAC,IAAI,CAAC,IAAI,CAAC;IAC/B,CAAC;IAED,kCAAW,GAAX,UAAY,MAAO;QAEf,IAAI,CAAC,MAAM,GAAG,MAAM,CAAC;IACzB,CAAC;IAGD,iCAAU,GAAV,UAAW,MAAc,EAAC,GAAS;QAAnC,iBAKC;QALyB,oBAAA,EAAA,SAAS;QAC/B,IAAI,MAAM,GAAG,gCAAiB,CAAC,MAAM,CAAC,GAAG,EAAC,IAAI,CAAC,MAAM,CAAC,CAAC,EAAC,MAAM,EAAC,UAAA,KAAK;YAChE,KAAI,CAAC,MAAM,CAAC,CAAC,GAAG,KAAK,CAAC;QAC1B,CAAC,CAAC,CAAC,MAAM,CAAC,EAAE,CAAC,aAAa,EAAE,CAAC,CAAA;QAC7B,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,CAAA;IAC/B,CAAC;IAED,6BAAM,GAAN,UAAO,IAAY;QAEf,IAAI,GAAG,GAAG,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,EAAC,IAAI,CAAC,MAAM,GAAC,CAAC,CAAC,CAAC,CAAA;QACnD,IAAI,GAAG,GAAG,IAAI,CAAC,MAAM,CAAC,qBAAqB,CAAC,GAAG,EAAC,EAAE,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;QAC9D,IAAG,GAAG,CAAC,CAAC,GAAG,CAAC,EAAE,CAAC,WAAW,CAAC,MAAM,GAAC,CAAC,EAAC;YAChC,OAAO,IAAI,CAAA;SACd;QACD,OAAO,KAAK,CAAA;IAChB,CAAC;IAED,6BAAM,GAAN;QAEI,IAAG,CAAC,IAAI,CAAC,MAAM;YAAE,OAAO;QACxB,sDAAsD;QACtD,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC,GAAG,IAAI,CAAC,MAAM,CAAC,CAAC,GAAG,IAAI,CAAC,MAAM,CAAC,CAAC,CAAC;QACnD,iCAAiC;QACjC,gDAAgD;QAChD,yDAAyD;QACzD,8BAA8B;QAC9B,wDAAwD;IAC5D,CAAC;IAnDD;QADC,QAAQ,CAAC,EAAE,CAAC,IAAI,CAAC;gDACI;IAJL,YAAY;QAFhC,OAAO;QACP,gBAAgB,CAAC,EAAE,CAAC,MAAM,CAAC;OACP,YAAY,CA0DhC;IAAD,mBAAC;CA1DD,AA0DC,CA1DyC,EAAE,CAAC,SAAS,GA0DrD;kBA1DoB,YAAY","file":"","sourceRoot":"/","sourcesContent":["import { ValueChangeAction } from \"../../misc/BoostsAction\";\r\n\r\nconst {ccclass, property,requireComponent} = cc._decorator;\r\n\r\n@ccclass\r\n@requireComponent(cc.Camera)\r\nexport default class FollowCamera extends cc.Component {\r\n    camera:cc.Camera;\r\n\r\n    @property(cc.Node)\r\n    target:cc.Node = null;\r\n\r\n    offset: cc.Vec2 = cc.Vec2.ZERO;\r\n\r\n    onLoad()\r\n    {\r\n        this.camera = this.getComponent(cc.Camera);\r\n    }\r\n\r\n    start () {\r\n    }\r\n\r\n    reset()\r\n    {\r\n        this.node.y = 0;\r\n        this.offset = cc.Vec2.ZERO;\r\n    }\r\n\r\n    startFollow(target?)\r\n    {\r\n        this.target = target;\r\n    }\r\n    velocity:cc.Vec2 = cc.Vec2.ZERO;\r\n\r\n    animOffset(offset: number,dur = 1.0): any {\r\n        let action = ValueChangeAction.create(dur,this.offset.y,offset,value=>{\r\n            this.offset.y = value;\r\n        }).easing(cc.easeSineInOut())\r\n        this.node.runAction(action)\r\n    }\r\n\r\n    canSee(node:cc.Node)\r\n    {\r\n        let top = node.position.add(cc.v3(0,node.height/2))\r\n        let pos = this.camera.getWorldToCameraPoint(top,cc.Vec2.ZERO);\r\n        if(pos.y > -cc.visibleRect.height/2){\r\n            return true\r\n        }\r\n        return false\r\n    }\r\n\r\n    update()\r\n    {\r\n        if(!this.target) return;\r\n        // this.camera.node.y = this.target.y + this.offset.y;\r\n        this.camera.node.x = this.target.x + this.offset.x;\r\n        // let pos = this.node.position; \r\n        // let vec = this.target.node.position.sub(pos);\r\n        // vec.normalizeSelf().mulSelf(10).subSelf(this.velocity)\r\n        // this.velocity.addSelf(vec);\r\n        // this.camera.node.setPosition(pos.add(this.velocity));\r\n    }\r\n\r\n    // update (dt) {}\r\n}\r\n"]}