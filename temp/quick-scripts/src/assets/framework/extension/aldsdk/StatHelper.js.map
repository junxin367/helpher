{"version":3,"sources":["assets\\framework\\extension\\aldsdk\\StatHelper.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import Net from \"../../misc/Net\";\r\nimport { UserInfo } from \"../weak_net_game/UserInfo\";\r\nimport { TTGameConfig } from \"../ttsdk/TTGameConfigs\";\r\nimport { QQGameConfig } from \"../qq/QQGameConfigs\";\r\nimport { GameConfig } from \"../wxsdk/GameConfigs\";\r\n\r\nconst { ccclass, property } = cc._decorator;\r\n\r\nexport enum EventType {\r\n    paySuccess,\r\n    payFail,\r\n    tools,\r\n    revive,\r\n    award,\r\n}\r\n\r\nexport enum LevelEndEventType {\r\n    Exit = 0,\r\n    Win = 1,\r\n    Lose = 2\r\n}\r\n\r\n\r\n\r\n@ccclass\r\nexport default class StatHepler {\r\n    static level_end_event: LevelEndEventType = LevelEndEventType.Exit\r\n    static current_lv_desc: string = \"\"\r\n    static isInLevel = false;\r\n\r\n\r\n    static _userId: string = '';\r\n    static levelId: string = '0';\r\n    static client = new Net()\r\n\r\n    static init(userId) {\r\n        this._userId = userId\r\n    }\r\n\r\n    static startLevel(levelId, lv_desc) {\r\n        this.levelId = levelId;\r\n        this.current_lv_desc = lv_desc\r\n        //默认为退出，其它 状态 会设置 成功或者 失败,不设置 就是退出\r\n        StatHepler.level_end_event = LevelEndEventType.Exit;\r\n        if (cc.sys.platform == cc.sys.WECHAT_GAME) {\r\n            wx.aldStage.onStart({\r\n                stageId: levelId,\r\n                stageName: this.current_lv_desc,\r\n                userId: this._userId\r\n            });\r\n        }\r\n        this.isInLevel = true;\r\n    }\r\n\r\n    static setLevelEndEvent(evt: LevelEndEventType) {\r\n        StatHepler.level_end_event = evt;\r\n    }\r\n\r\n    static userAction(eventName, k?, v?) {\r\n        if (cc.sys.platform == cc.sys.WECHAT_GAME) {\r\n            if (k) {\r\n                let param = {}\r\n                param[k] = v;\r\n                wx.aldSendEvent(eventName, param)\r\n            } else {\r\n                let param = {}\r\n                param[\"userId\"] = this._userId;\r\n                wx.aldSendEvent(eventName)\r\n            }\r\n        }\r\n    }\r\n\r\n    public static sendPath(name, title?, val?) {\r\n        // if(cc.sys.platform == cc.sys.WECHAT_GAME){\r\n        // window['zzsdkui'].aliEvent(name, {\r\n        //     [title]: val || 1\r\n        // });\r\n        // return;\r\n        // }\r\n\r\n        // let appid = \"\";\r\n        // if(window.tt){\r\n        //     appid = TTGameConfig.tt_appid;\r\n        // }else if(window.qq){\r\n        //     appid = QQGameConfig.qq_appid;\r\n        // }else if(CC_WECHATGAME){\r\n        //     appid = GameConfig.wx_appid;\r\n        // }    \r\n        // var sendData = {\r\n        //     xsl_uuid: UserInfo.userId,\r\n        //     xsl_appid: appid,\r\n        //     xsl_et_action: name,\r\n        //     xsl_et_label: title,\r\n        //     xsl_et_value: val || 1\r\n        // };\r\n        // this.client.httpGet(\"https://r.d1fm.com/r.gif\", sendData);\r\n        if(cc.sys.os == cc.sys.OS_IOS){\r\n            // jsb.reflection.callStaticMethod(\"GDTSdk\", \"applicationLogAction:count:\", name,title + val);\r\n        }\r\n    }\r\n\r\n\r\n\r\n    static doLevelEvent(eventType: EventType, itemName, itemId, itemCount = 1, itemMoney = \"1\") {\r\n        if (!this.isInLevel) return;\r\n        if (cc.sys.platform == cc.sys.WECHAT_GAME) {\r\n            wx.aldStage.onRunning({\r\n                stageId: this.levelId,\r\n                stageName: this.current_lv_desc,\r\n                userId: this._userId,\r\n                event: EventType[eventType],\r\n                params: {\r\n                    itemName, itemId, itemCount, itemMoney\r\n                }\r\n            })\r\n        }\r\n    }\r\n\r\n    static endLevel() {\r\n        //统计\r\n        //------------------------------------------------------------------------------//\r\n        let desc = \"\"\r\n        let ald_event = ''\r\n        switch (StatHepler.level_end_event) {\r\n            case LevelEndEventType.Win:\r\n                desc = \"完成关卡\"\r\n                ald_event = 'complete'\r\n                break;\r\n            case LevelEndEventType.Lose:\r\n                desc = \"关卡失败\"\r\n                ald_event = \"fail\"\r\n                break;\r\n            case LevelEndEventType.Exit:\r\n                desc = \"中途退出\"\r\n                ald_event = \"fail\"\r\n                return;\r\n            // break;\r\n        }\r\n        if (cc.sys.platform == cc.sys.WECHAT_GAME) {\r\n            wx.aldStage.onEnd({\r\n                stageId: this.levelId,\r\n                stageName: this.current_lv_desc,\r\n                userId: this._userId,\r\n                event: ald_event,\r\n                params: {\r\n                    desc\r\n                }\r\n            });\r\n        }\r\n        this.isInLevel = false;\r\n        //------------------------------------------------------------------------------//\r\n    }\r\n\r\n}"]}