{"version":3,"sources":["assets\\framework\\core\\DataCenter.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import { evt } from \"./event\";\r\n\r\n\r\ninterface FieldOption {\r\n    propertyName: any, // 字段名\r\n    persistent: boolean,  //是否持久化，\r\n    enumerable: any,//是否可遍历，false时  toString()不会输出该字段到JSON\r\n    readonly: boolean,//不可以给该字段设置值，只可读取\r\n}\r\n\r\nconst all_class_fields: { [index: string]: FieldOption[] } = {}\r\n\r\nconst all_registed_class = {}\r\nexport function dc(name, serializable = true): Function {\r\n    return function (target: any) {\r\n        // target.endRegister(name);\r\n        // let proto: any = target['prototype'].constructor;\r\n        // let cls = all_class_properties[proto]\r\n        all_registed_class[target] = { name, serializable };\r\n    }\r\n}\r\nexport function field(obj?: { default?: any, persistent?: boolean, enumerable?: boolean, readonly?: boolean }) {\r\n    return function (target: any, propertyName: string) {\r\n        // target.register(propertyName,target[propertyName])\r\n        let constructor = target.constructor\r\n        let fields = all_class_fields[constructor]\r\n        if (fields == null) {\r\n            fields = []\r\n            all_class_fields[constructor] = fields;\r\n        }\r\n        obj = obj || {}\r\n        if (obj) {\r\n            //set default properties\r\n            obj.persistent = obj.persistent == null ? true : obj.persistent;\r\n            obj.enumerable = obj.enumerable == null ? true : obj.enumerable;\r\n            obj.readonly = obj.readonly || false;\r\n            if (obj.default)\r\n                target[propertyName] = obj.default;\r\n        }\r\n        let filed = { propertyName, persistent: obj.persistent, enumerable: obj.enumerable, readonly: obj.readonly } as FieldOption;\r\n        fields.push(filed);\r\n    }\r\n}\r\n\r\n\r\nexport default class DataCenter {\r\n    private __namespace: string = \"DataCenter\"\r\n    static alldata = {}\r\n    private kvs = {}\r\n    private kts = {}\r\n    private defaultKvs = {}\r\n    private kOptions: { [index: string]: FieldOption } = {}\r\n    constructor() {\r\n        this.kvs = {}\r\n        this.kts = {}\r\n    }\r\n    ///保存时间\r\n    save_timestamps: number = 0;\r\n\r\n    toFormData() {\r\n        let postData = this.allkeys.map(key => `${key}=${this.kvs[key]}`).join(\"&\")\r\n        return postData\r\n    }\r\n\r\n\r\n    get allkeys() {\r\n        return Object.keys(this.kvs);\r\n    }\r\n\r\n    public defaultValue(key) {\r\n        return this.defaultKvs[key]\r\n    }\r\n\r\n    public resetValue(key) {\r\n        // this.kvs[k] = a[k]\r\n        this.setData(key, this.defaultKvs[key])\r\n    }\r\n\r\n\r\n    private registerFields(namespace?) {\r\n        let target = this[\"__proto__\"].constructor\r\n        let fields = all_class_fields[target]\r\n        let cfg = all_registed_class[target]\r\n        // let proto:any = target['prototype'];\r\n        for (var i in fields) {\r\n            let f = fields[i];\r\n            let k = f.propertyName\r\n            this.kOptions[k] = f;\r\n            if (typeof (k) == \"function\") continue;\r\n            this.register(k, this[k])\r\n            delete this[k]; //删除默认属性 ,否则设置 setter getter 会失效\r\n        }\r\n\r\n        this.kOptions['save_timestamps'] = { propertyName: 'save_timestamps', persistent: true, enumerable: true, readonly: false };\r\n        this.register('save_timestamps', 0);\r\n        delete this['save_timestamps']\r\n\r\n        namespace = namespace || cfg.name;\r\n        this.endRegister(namespace, cfg.serializable)\r\n    }\r\n\r\n    register(k, defaultValue) {\r\n        let proto: any = this.constructor[\"prototype\"]\r\n        let self = this;\r\n        proto.__defineGetter__(k, function () {\r\n            return self.getData(k);\r\n        })\r\n        proto.__defineSetter__(k, function (s) {\r\n            self.setData(k, s)\r\n        })\r\n        this.defaultKvs[k] = defaultValue;\r\n        let option = this.kOptions[k]\r\n        Object.defineProperty(this.kvs, k, {\r\n            value: defaultValue,\r\n            enumerable: option.enumerable,\r\n            writable: true,\r\n        })\r\n        let type = \"\"\r\n        type = typeof (defaultValue);\r\n        if (type == 'object') {\r\n            if (Array.isArray(defaultValue)) {\r\n                type = 'array'\r\n            }\r\n        }\r\n        this.kts[k] = type;\r\n        console.log(\"[DataCenter] register :\" + k + \":\" + defaultValue + \"(\" + type + \")\")\r\n    }\r\n\r\n    /**\r\n     * setData 会发消息 \r\n     * setValue 强制改变该字段 值 \r\n     */\r\n    setValue(k, v) {\r\n        this.kvs[k] = v;\r\n    }\r\n\r\n    setData(k, nv) {\r\n        let v = this.kvs[k]\r\n        if (v == nv) return;\r\n        let kOption = this.kOptions[k]\r\n        if (kOption.readonly) return;\r\n        let type = this.kts[k]\r\n        let kk = this._field_(k)\r\n        if (type != typeof (nv)) {\r\n            if (type == \"number\") {\r\n                console.warn(\"[DataCenter] wrong type <\" + typeof (nv) + \"> for :\" + kk + \"<\" + type + \"> ,converting...\")\r\n                if (nv == null) {\r\n                    nv = 0\r\n                } else {\r\n                    nv = Number(nv)\r\n                }\r\n            }\r\n            else if (type == \"boolean\") {\r\n                console.warn(\"[DataCenter] wrong type <\" + typeof (nv) + \"> for :\" + kk + \"<\" + type + \"> ,converting...\")\r\n                nv = (nv == \"true\") ? true : false\r\n            } else if (type == \"object\") {\r\n                console.warn(\"[DataCenter] wrong type <\" + typeof (nv) + \"> for :\" + kk + \"<\" + type + \"> ,converting...\")\r\n                nv = nv && this.parseJson(nv) || {};\r\n            } else if (type == 'array' && Array.isArray(nv)) {\r\n                nv = nv\r\n            }\r\n        }\r\n        this.kvs[k] = nv;\r\n        // if (!cc.sys.isMobile) console.log(\"[DataCenter] onValueChanged\", kk, nv);\r\n        evt.emit(kk, nv, v)\r\n    }\r\n\r\n    private _field_(k) {\r\n        return this.__namespace + \".\" + k\r\n    }\r\n\r\n    getData(k) {\r\n        return this.kvs[k];\r\n    }\r\n\r\n    limit(v, min, max) {\r\n        if (v > max) {\r\n            return max;\r\n        } else if (v < min) {\r\n            return 0;\r\n        } else {\r\n            return v;\r\n        }\r\n    }\r\n\r\n    addData(k, c, autosave = false) {\r\n        c = Number(c)\r\n        if (c == null) return;\r\n        let v = this.kvs[k]\r\n        let nv = Number(v) + c\r\n        this.kvs[k] = nv\r\n        evt.emit(this._field_(k), nv, v)\r\n        if (autosave)\r\n            this.save(k);\r\n    }\r\n\r\n    onLoad(field_name) { }\r\n    onLoadAll() { }\r\n    onBeforeSave(field_name) { }\r\n    onAfterSave(field_name) { }\r\n    onBeforeSaveAll() { }\r\n    onAfterSaveAll() { }\r\n\r\n    private load() {\r\n        for (var k in this.kvs) {\r\n            let fromstroage = localStorage.getItem(this._field_(k))\r\n            let v: any = fromstroage\r\n            if (fromstroage) {\r\n                let type = this.kts[k]\r\n                if (type == \"number\") {\r\n                    v = Number(fromstroage);\r\n                } else if (type == \"boolean\") {\r\n                    v = fromstroage == \"true\" ? true : false;\r\n                } else if (type == \"object\" || type == 'array') {\r\n                    v = this.parseJson(fromstroage);\r\n                }\r\n            } else {\r\n                v = this.getData(k);\r\n            }\r\n            this.kvs[k] = v;\r\n            this.onLoad(k);\r\n        }\r\n        this.onLoadAll();\r\n\r\n    }\r\n\r\n\r\n\r\n    private _saveAll() {\r\n        this.save_timestamps = Date.now();\r\n        for (var k in this.kvs) {\r\n            let option = this.kOptions[k]\r\n            //此字段不支持序列化\r\n            if (option.persistent == false || option.readonly == true) {\r\n                continue;\r\n            }\r\n            let v = this.kvs[k]\r\n            let t = this.kts[k]\r\n            let kk = this._field_(k)\r\n            this.onBeforeSave(k);\r\n            if (v != null) {\r\n                if (t == \"object\" || t == 'array') {\r\n                    localStorage.setItem(kk, JSON.stringify(v));\r\n                } else {\r\n                    localStorage.setItem(kk, v.toString());\r\n                }\r\n            }\r\n            this.onAfterSave(k);\r\n            console.log(kk, v)\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 保存数据 \r\n     * @param keys 需要保存的key[list]，如果为空 ，则保存全部字段\r\n     */\r\n    save(...keys) {\r\n        console.log(\"[DataCenter] save :==================================\")\r\n        if (keys.length == 0) {\r\n            this.onBeforeSaveAll()\r\n            this._saveAll();\r\n            this.onAfterSaveAll()\r\n        } else {\r\n            for (var i in keys) {\r\n                let k = keys[i]\r\n                let option = this.kOptions[k]\r\n                if (option == null) {\r\n                    return console.warn(\"[DataCenter]: can't find the key :\" + k)\r\n                }\r\n                //此字段不支持序列化\r\n                if (option.persistent == false || option.readonly == true) {\r\n                    continue;\r\n                }\r\n                let v = this.kvs[k]\r\n                let t = this.kts[k]\r\n                let kk = this._field_(k)\r\n                this.onBeforeSave(k);\r\n                if (t == \"object\" || t == 'array') {\r\n                    localStorage.setItem(kk, JSON.stringify(v));\r\n                } else {\r\n                    if (v != null) {\r\n                        localStorage.setItem(kk, v.toString());\r\n                    } else {\r\n                        console.warn(\"[DataCenter] \" + kk + \" 保存失败\")\r\n                    }\r\n                }\r\n                this.onAfterSave(k);\r\n                console.log(kk, v)\r\n            }\r\n        }\r\n        console.log(\"[DataCenter] save succ :==================================\")\r\n        // localStorage.setItem(\"#1_coin\",this.getData(\"coin\"));\r\n    }\r\n\r\n    toString() {\r\n        let s = JSON.stringify(this.kvs, function (key, value) {\r\n            if (typeof value == 'string') {\r\n                let c = value.replace(/\\\\?\\\"/g, \"'\")\r\n                return c;\r\n            }\r\n            return value\r\n        })\r\n        console.log('dc.tostring:', s);\r\n        return s\r\n    }\r\n\r\n    loadFromJsonObject(a) {\r\n        for (var k in this.kvs) {\r\n            let v = a[k]\r\n            if (v != null) {\r\n                // this.setData(k, v)\r\n                this.setValue(k, v);\r\n                this.onLoad(k);\r\n            }\r\n        }\r\n        this.onLoadAll();\r\n    }\r\n\r\n    loadFromString(s) {\r\n        let a = JSON.parse(s);\r\n        this.loadFromJsonObject(a);\r\n    }\r\n\r\n    resetAndSave(initValues?) {\r\n        this.reset();\r\n        for (var k in initValues) {\r\n            this.setValue(k, initValues[k])\r\n        }\r\n        this.save();\r\n        return true;\r\n    }\r\n\r\n    reset() {\r\n        for (var k in this.kvs) {\r\n            // this.kvs[k] = a[k]\r\n            this.setValue(k, this.defaultKvs[k])\r\n            this.onLoad(k);\r\n        }\r\n        this.onLoadAll()\r\n    }\r\n\r\n    parseJson(s) {\r\n        try {\r\n            let obj = JSON.parse(s.replace(/\\\\?\\'/g, '\"'))\r\n            return obj;\r\n        } catch (e) {\r\n            return null\r\n        }\r\n    }\r\n\r\n    private endRegister(s, serializable = true) {\r\n        this.__namespace = s;\r\n        DataCenter.alldata[s] = this;\r\n        if (serializable) {\r\n            this.load()\r\n            // this.save();\r\n        }\r\n    }\r\n\r\n    static off(k, callback, target?) {\r\n        evt.off(k, callback, target);\r\n    }\r\n\r\n    static on(k, callback, target?) {\r\n        evt.on(k, callback, target)\r\n        this.set(k, this.get(k))\r\n    }\r\n\r\n    static get(k) {\r\n        let strs = k.split(\".\")\r\n        let namespace = strs[0];\r\n        let name = strs[1];\r\n        let target = DataCenter.alldata[namespace]\r\n        if (target)\r\n            return target[name]\r\n        else\r\n            return null;\r\n    }\r\n\r\n    static set(k, v) {\r\n        let strs = k.split(\".\")\r\n        let namespace = strs[0];\r\n        let name = strs[1];\r\n        let target = DataCenter.alldata[namespace]\r\n        if (target) {\r\n            target[name] = v;\r\n        }\r\n    }\r\n\r\n    static register(cls) {\r\n        if (CC_EDITOR) return;\r\n        let v = new cls();\r\n        let d = all_registed_class[cls]\r\n        // g.setGlobalInstance(v, d.name)\r\n        window[d.name] = v;\r\n        v.registerFields()\r\n        return v;\r\n    }\r\n}"]}